<!DOCTYPE html>
<html>
<head>
    <title>[#SOLR-1301] Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce.</title>
    <meta http-equiv="Content-Type" Content="application/vnd.ms-word; charset=utf-8">
        <style type="text/css">

.tableBorder, .grid
{
    background-color: #fff;
    width: 100%;
    border-collapse: collapse;
}

.tableBorder td, .grid td
{
    vertical-align: top;
    padding: 2px;
    border: 1px solid #ccc;
}

.noPadding
{
    padding: 0 !important;
}

h3 .subText
{
    font-size: 60%;
    font-weight: normal;
}

.tabLabel
{
    font-weight: bold;
    border: 1px solid #ccc;
    border-bottom:none;
    padding: 2px;
    display: inline;
}

td.blank
{
    padding: 0;
    margin: 0;
}

.blank td
{
    border: none;
}

#descriptionArea
{
    margin: 0;
    padding: 2px;
    border: 1px solid #ccc;
}

hr
{
    border-top:1px solid #aaa;
}

hr.fullcontent
{
  height: 15px;
  padding: 10px 0;
  background: #fff url('https://issues.apache.org/jira/images/icons/hr.gif') no-repeat scroll center;
}

</style>

</head>
<body>

<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [SOLR-1301]&nbsp;<a href="https://issues.apache.org/jira/browse/SOLR-1301">Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce.</a>
            <span class="subText">
               Created: 22/Jul/09                   &nbsp;Updated: 21/Mar/14

                                                    &nbsp;Resolved: 14/Feb/14
                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">Closed</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://issues.apache.org/jira/secure/BrowseProject.jspa?id=12310230">Solr</a></td>
    </tr>

        <tr>
            <td><b>Component/s:</b></td>
            <td>
                            None
                </td>
    </tr>
    

        <tr>
            <td><b>Affects Version/s:</b></td>
            <td>
                            None
                </td>
    </tr>
    

        <tr>
            <td><b>Fix Version/s:</b></td>
            <td>
                                        <a title="4.7 - Major release after 4.6"
                href="https://issues.apache.org/jira/secure/IssueNavigator.jspa?reset=true&mode=hide&sorter/order=ASC&sorter/field=priority&pid=12310230&fixfor=12325573"
            >4.7</a>,                    <a title="5.0 - Current trunk"
                href="https://issues.apache.org/jira/secure/IssueNavigator.jspa?reset=true&mode=hide&sorter/order=ASC&sorter/field=priority&pid=12310230&fixfor=12321664"
            >5.0</a>                        </td>
    </tr>
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            New Feature
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Major
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                            <a class="user-hover" rel="ab" id="word_reporter_ab" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ab">Andrzej Bialecki </a>
                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                            <a class="user-hover" rel="markrmiller@gmail.com" id="word_assignee_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                            Fixed
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                30
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-12431129-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            None
                    </td>
    </tr>
    
    	<tr>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Original Estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap width="80%" colspan="3">
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

                <tr>
            <td bgcolor="#f0f0f0" width=20% valign=top>
                <b>Attachments:</b>
            </td>
            <td bgcolor="#ffffff" valign="top">
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        README.txt &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301-hadoop-0-20.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301-hadoop-0-20.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301-maven-intellij.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        SOLR-1301.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/java.gif" height="16" width="16" alt="Java Source File" />
                                        SolrRecordWriter.java &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/java.gif" height="16" width="16" alt="Java Archive File" />
                                        commons-logging-1.0.4.jar &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/java.gif" height="16" width="16" alt="Java Archive File" />
                                        commons-logging-api-1.0.4.jar &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/java.gif" height="16" width="16" alt="Java Archive File" />
                                        hadoop-0.19.1-core.jar &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/java.gif" height="16" width="16" alt="Java Archive File" />
                                        hadoop-0.20.1-core.jar &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/java.gif" height="16" width="16" alt="Java Archive File" />
                                        hadoop-core-0.20.2-cdh3u3.jar &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/text.gif" height="16" width="16" alt="Text File" />
                                        hadoop.patch &nbsp;&nbsp;&nbsp;
                                                            <img src="https://issues.apache.org/jira/images/icons/attach/java.gif" height="16" width="16" alt="Java Archive File" />
                                        log4j-1.2.15.jar &nbsp;&nbsp;&nbsp;
                            </td>
        </tr>
        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue Links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Reference</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                relates to
            </td>
            <td>
                <a href="https://issues.apache.org/jira/browse/SOLR-1045">
                     SOLR-1045                 </a>
            </td>
            <td>
                Build Solr index using Hadoop MapReduce
            </td>
            <td>
                Open
            </td>
        </tr>
                                        <tr>
            <td>
                is related to
            </td>
            <td>
                <a href="https://issues.apache.org/jira/browse/SOLR-5667">
                     <strike>SOLR-5667</strike>                 </a>
            </td>
            <td>
                Performance problem when not using hd...
            </td>
            <td>
                Closed
            </td>
        </tr>
            <tr>
            <td>
                is related to
            </td>
            <td>
                <a href="https://issues.apache.org/jira/browse/SOLR-1457">
                     <strike>SOLR-1457</strike>                 </a>
            </td>
            <td>
                Deploy shards from HDFS into local cores
            </td>
            <td>
                Closed
            </td>
        </tr>
            <tr>
            <td>
                is related to
            </td>
            <td>
                <a href="https://issues.apache.org/jira/browse/SOLR-5758">
                     SOLR-5758                 </a>
            </td>
            <td>
                need ref guide doc on building indexe...
            </td>
            <td>
                Open
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    



</table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p>This patch contains  a contrib module that provides distributed indexing (using Hadoop) to Solr EmbeddedSolrServer. The idea behind this module is twofold:</p>

<ul>
	<li>provide an API that is familiar to Hadoop developers, i.e. that of OutputFormat</li>
	<li>avoid unnecessary export and (de)serialization of data maintained on HDFS. SolrOutputFormat consumes data produced by reduce tasks directly, without storing it in intermediate files. Furthermore, by using an EmbeddedSolrServer, the indexing task is split into as many parts as there are reducers, and the data to be indexed is not sent over the network.</li>
</ul>


<p>Design<br/>
----------</p>

<p>Key/value pairs produced by reduce tasks are passed to SolrOutputFormat, which in turn uses SolrRecordWriter to write this data. SolrRecordWriter instantiates an EmbeddedSolrServer, and it also instantiates an implementation of SolrDocumentConverter, which is responsible for turning Hadoop (key, value) into a SolrInputDocument. This data is then added to a batch, which is periodically submitted to EmbeddedSolrServer. When reduce task completes, and the OutputFormat is closed, SolrRecordWriter calls commit() and optimize() on the EmbeddedSolrServer.</p>

<p>The API provides facilities to specify an arbitrary existing solr.home directory, from which the conf/ and lib/ files will be taken.</p>

<p>This process results in the creation of as many partial Solr home directories as there were reduce tasks. The output shards are placed in the output directory on the default filesystem (e.g. HDFS). Such part-NNNNN directories can be used to run N shard servers. Additionally, users can specify the number of reduce tasks, in particular 1 reduce task, in which case the output will consist of a single shard.</p>

<p>An example application is provided that processes large CSV files and uses this API. It uses a custom CSV processing to avoid (de)serialization overhead.</p>

<p>This patch relies on hadoop-core-0.19.1.jar - I attached the jar to this issue, you should put it in contrib/hadoop/lib.</p>

<p>Note: the development of this patch was sponsored by an anonymous contributor and approved for release under Apache License.</p>
            <br/>
        </td>
    </tr>
    </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Comments</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%" class="grid" style="margin: 0;">
                <tr id="comment-header-12734376"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">23/Jul/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12734376"><td bgcolor="#ffffff">
            <p>I downloaded the patch.  I'd like to be able to execute this as an ant target and integrate (if possible) test cases?  </p>
        </td></tr>
                <tr id="comment-header-12736944"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">30/Jul/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12736944"><td bgcolor="#ffffff">
            <p>I think we'll want to integrate this patch with Katta which<br/>
conveniently creates many shards and merges them in Hadoop. </p>

<p>The merging in Hadoop is a bit tricky as if we create numerous<br/>
shards using the current patch, merging the shards into the<br/>
existing index with MergeIndexesCommand would likely create too<br/>
much IO and CPU overhead on what would be the search server and<br/>
possibly degrade search performance. </p>

<p>Instead of maintaining separate write servers, I would rather<br/>
allocate all Solr servers as read only, and rely on Hadoop (with<br/>
EC2) for quickly reindexing all documents (i.e. for a schema<br/>
change) or incremental indexing. I'm not sure how documents<br/>
updates should be handled.</p>
        </td></tr>
                <tr id="comment-header-12737120"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">30/Jul/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12737120"><td bgcolor="#ffffff">
            <p>Thought I haven't tested it, in browsing the Katta code it looks<br/>
like it isn't merging shards in Hadoop as I couldn't find a call<br/>
to IW.addIndexes (which is used to merge indexes in different<br/>
directories). I'm not sure how expensive it is to copy two<br/>
shards out of HDFS, merge them, then copy the newly merged shard<br/>
back to to HDFS, delete the old shards, then notify Zookeeper of<br/>
the changes.  Maybe we can expand on this patch to add those<br/>
capabilities, or add the functionality to Katta.</p>
        </td></tr>
                <tr id="comment-header-12737253"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="ab" id="word_commented_ab" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ab">Andrzej Bialecki </a>
                                        <font size="-2">
            [
                <font color="#336699">30/Jul/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12737253"><td bgcolor="#ffffff">
            <p>This patch is intended to work with Solr as it is now, and the idea is to use Hadoop to buld shards (in the Solr sense) so that they could be used by the current Solr distributed search. I have no idea how / whether Katta/Zookeeper fits in this picture - if you want to pursue this integration I feel it would be best to do it in a separate issue.</p>
        </td></tr>
                <tr id="comment-header-12737299"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">30/Jul/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12737299"><td bgcolor="#ffffff">
            <p>Andrzej,</p>

<ul>
	<li>Are you going to add a way to automatically add an index to a Solr core?</li>
</ul>


<ul>
	<li>Are you planning on adding test cases for this patch?</li>
</ul>


<ul>
	<li>How does one set the maximum size of a generated shard?</li>
</ul>

        </td></tr>
                <tr id="comment-header-12737306"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="ab" id="word_commented_ab" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ab">Andrzej Bialecki </a>
                                        <font size="-2">
            [
                <font color="#336699">30/Jul/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12737306"><td bgcolor="#ffffff">
            <blockquote><p>Are you going to add a way to automatically add an index to a Solr core?</p></blockquote>

<p>This way already exists by (ab)using the forced replication to a slave from a temporary master.</p>

<blockquote><p>Are you planning on adding test cases for this patch?</p></blockquote>

<p>This functionality requires a running Hadoop cluster. I'm not sure how to write functional tests without bringing more Hadoop dependencies. I could add unit tests that test some aspects of the patch, but they would be trivial.</p>

<blockquote><p>How does one set the maximum size of a generated shard?</p></blockquote>

<p>One doesn't, at the moment <img class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/wink.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> The size of each shard (in # of documents) is a function of the total number of records divided by the number of reduce tasks.</p>
        </td></tr>
                <tr id="comment-header-12737568"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kkrugler" id="word_commented_kkrugler" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkrugler">Ken Krugler</a>
                                        <font size="-2">
            [
                <font color="#336699">31/Jul/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12737568"><td bgcolor="#ffffff">
            <p>Hi Jason,</p>

<p>Re Katta, you're right that it doesn't support merging indexes. In a way, it does run-time merging by searching across multiple shards, though you can't add new shards to a deployed index. Some people work around this by searching in all indexes, which is a different level of run-time merging that Katta supports.</p>

<p>In general I think everybody agrees that merging indexes on the search servers is a bad idea, due to potentially high loads impacting end-user search performance. The most common approach I've seen is to use a general map-reduce job in Hadoop to generate N shards, controlled via number of reducers, and then deploy this as a branch new Katta index.</p>

<p>&#8211; Ken</p>
        </td></tr>
                <tr id="comment-header-12747492"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jv_ning" id="word_commented_jv_ning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jv_ning">Jason Venner (www.prohadoop.com)</a>
                                        <font size="-2">
            [
                <font color="#336699">25/Aug/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12747492"><td bgcolor="#ffffff">
            <p>Anyone using this patch set?</p>

<p>What are people using for the reduce piece shard size, that will be merged, and a final shard for searching?</p>

<p>I am going to give it a try, I have one change I am going to hack in, which is to allow an existing zip file to hold the solr data to avoid having to rebuild and push it out for each job run.</p>
        </td></tr>
                <tr id="comment-header-12747525"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">25/Aug/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12747525"><td bgcolor="#ffffff">
            <p>Jv,</p>

<p>I've used the patch.  It works, though I'm sure there are changes and additions that can be made.  Why would you want to put the data (i.e. the index files) into the zip?</p>

<p>-J</p>
        </td></tr>
                <tr id="comment-header-12747542"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jv_ning" id="word_commented_jv_ning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jv_ning">Jason Venner (www.prohadoop.com)</a>
                                        <font size="-2">
            [
                <font color="#336699">25/Aug/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12747542"><td bgcolor="#ffffff">
            <p>currently you pass the directory of your solr conf/lib to the job, which makes a zip file, and loads it into hdfs. my mod would be to simply allow pointing at an existing config zip file in hdfs, to minimize the job start time.</p>
        </td></tr>
                <tr id="comment-header-12748935"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jv_ning" id="word_commented_jv_ning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jv_ning">Jason Venner (www.prohadoop.com)</a>
                                        <font size="-2">
            [
                <font color="#336699">28/Aug/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12748935"><td bgcolor="#ffffff">
            <p>I have used this at a decent scale, and will be adding a few patches, to allow mutliple tasks per machine to build.</p>

<p>The code currently uses the same directory in /tmp for the solr config, and if multipel tasks are running, the directory may be removed by earlier tasks that finish.</p>
        </td></tr>
                <tr id="comment-header-12752006"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jv_ning" id="word_commented_jv_ning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jv_ning">Jason Venner (www.prohadoop.com)</a>
                                        <font size="-2">
            [
                <font color="#336699">07/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12752006"><td bgcolor="#ffffff">
            <p>Updated patch with a little clearer documentation and safe to use when more than one instance of the output format is running on a single machine.<br/>
Also attempts to resolve the task timeouts during index updates and the index optimize phases of index building.</p>
        </td></tr>
                <tr id="comment-header-12753317"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">09/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12753317"><td bgcolor="#ffffff">
            <p>I think we can parallelize the indexing in SolrRecordWriter?<br/>
Meaning multiple threads add docs to Solr? Most machines will<br/>
have multiple cores and only one task is running per machine at<br/>
a time?</p>
        </td></tr>
                <tr id="comment-header-12753332"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jv_ning" id="word_commented_jv_ning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jv_ning">Jason Venner (www.prohadoop.com)</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12753332"><td bgcolor="#ffffff">
            <p>In my case, I have 6 tasks per machine, but only 4 disks, so I should<br/>
actually throttle.</p>

<p>It is an interesting trade of question of whether to make the writes run in<br/>
the background or to just block the job.</p>

<p>In operation on my cluster, the write time for each batch increases slowly<br/>
from nothing to 20 minutes as the job runs, and the system buffer cache and<br/>
the disk arms get saturated.</p>

<p>I also was lazy and didn't feel like holding exceptions from a background<br/>
writing thread and delivering them back to the writing thread, on the next<br/>
write or close call.<br/>
There are some operational hadoop api features that make the assumption that<br/>
an error is associated with the key, value that is being output. On the flip<br/>
side the buffered batch is already hiding potential errors associated with a<br/>
specific record...</p>

<p>The case you are referring to would be the MultiThreadedMapper case which is<br/>
not used widely, the only change for that, which I should have done, is make<br/>
the write and close thread safe, which they are explicitly not right now.</p>





        </td></tr>
                <tr id="comment-header-12753717"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12753717"><td bgcolor="#ffffff">
            <p>Here's jv ning's patch as a regular patch file to more easily see the changes.  JV, can you add notes on about what's changed and why?</p>
        </td></tr>
                <tr id="comment-header-12753731"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12753731"><td bgcolor="#ffffff">
            <p>Should we add ThreadedIndexWriter (from Lucene in Action<br/>
source <a href="http://www.manning.com/hatcher3/" class="external-link" rel="nofollow">http://www.manning.com/hatcher3/</a>) type of functionality<br/>
where we add documents in parallel using a thread pool? This<br/>
could increase performance on multicore machines.</p>
        </td></tr>
                <tr id="comment-header-12753739"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="yseeley@gmail.com" id="word_commented_yseeley@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yseeley%40gmail.com">Yonik Seeley</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12753739"><td bgcolor="#ffffff">
            <p>I don't know anything about ThreadedIndexWriter, but the SolrJ StreamingUpdateSolrServer uses multiple threads on the client side (and thus causes multiple threads to be used on the server side) to increase concurrency.  It's quite speedy.</p>
        </td></tr>
                <tr id="comment-header-12753754"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jv_ning" id="word_commented_jv_ning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jv_ning">Jason Venner (www.prohadoop.com)</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12753754"><td bgcolor="#ffffff">
            <p>Within a Map/Reduce task, there is usually a significant constraint on available ram, cpu and disk bandwidth.</p>

<p>For my current use case, if we turn on the various background write threads, I will need to make these configurable to help me manage the task resource consumption.</p>

<p>In the ideal world, the Map/Reduce framework, via cluster and job configuration, is taking care of running the tasks in parallel, and the tuning to optimize throughput is happening at that level.</p>
        </td></tr>
                <tr id="comment-header-12753756"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jv_ning" id="word_commented_jv_ning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jv_ning">Jason Venner (www.prohadoop.com)</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12753756"><td bgcolor="#ffffff">
            <p>My notes on the patchupdate were in a README.txt that didn't make it into the .patch for some reason.<br/>
Basically, the per task configuration uses the unpacked data that the framework creates, rather than creating a new configuration directory.<br/>
All paths used are task specific, so that multiple tasks can run concurrently without colliding.<br/>
The write method has a heartbeat thread so that the task does not get killed if the batch write takes more than 600 seconds.</p>
        </td></tr>
                <tr id="comment-header-12753763"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12753763"><td bgcolor="#ffffff">
            <ul>
	<li>I implemented a thread pool version, which eliminates the need<br/>
for adding in batches (which I'm not sure was necessary?)</li>
</ul>


<ul>
	<li>A numthreads property may be set</li>
</ul>


<ul>
	<li>A maxqueuesize may be set, which acts fulfills the same<br/>
function as batching</li>
</ul>


<ul>
	<li>It's untested yet</li>
</ul>

        </td></tr>
                <tr id="comment-header-12753765"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12753765"><td bgcolor="#ffffff">
            <p>Yonik,</p>

<p>It looks like StreamingUpdateSolrServer can't be used with EmbeddedSolrServer because of the requirement for a URL.</p>
        </td></tr>
                <tr id="comment-header-12753769"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12753769"><td bgcolor="#ffffff">
            <blockquote><p> In the ideal world, the Map/Reduce framework, via<br/>
cluster and job configuration, is taking care of running the<br/>
tasks in parallel, and the tuning to optimize throughput is<br/>
happening at that level. </p></blockquote>

<p>True, Hadoop should probably manage calling<br/>
SolrRecordWriter.write from multiple threads, or maybe it<br/>
already is? In which case there wouldn't be a need for thread<br/>
pooling or batching/queuing. </p>
        </td></tr>
                <tr id="comment-header-12754268"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kjirapinyo" id="word_commented_kjirapinyo" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kjirapinyo">Kris Jirapinyo</a>
                                        <font size="-2">
            [
                <font color="#336699">11/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12754268"><td bgcolor="#ffffff">
            <p>Because we are using MultipleOutputFormat, we can't have the data directory be the task_id, as when the indexes were building, the directories were conflicting.  This patch uses a random UUID instead as the data directory so that if there are more than one shards being created under a reducer, the directories will not conflict.</p>
        </td></tr>
                <tr id="comment-header-12754276"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jv_ning" id="word_commented_jv_ning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jv_ning">Jason Venner (www.prohadoop.com)</a>
                                        <font size="-2">
            [
                <font color="#336699">11/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12754276"><td bgcolor="#ffffff">
            <p>I have an updated version that uses a sequence number, to ensure uniqueness<br/>
in the multiple output format case.</p>

<p>Same concept, shorter path.</p>




        </td></tr>
                <tr id="comment-header-12754647"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jv_ning" id="word_commented_jv_ning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jv_ning">Jason Venner (www.prohadoop.com)</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12754647"><td bgcolor="#ffffff">
            <p>Updated SolrRecordWriter that uses a static AtomicLong to create a unique sequence number for each index instance created.<br/>
This allows safe use of MultipleOutputFormat as well as the original patch which allowed multiple task instances per machine.</p>

<p>The only potential issue is that the writer will block during index updates, which may cause the task to run slower than it could.</p>
        </td></tr>
                <tr id="comment-header-12754648"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jv_ning" id="word_commented_jv_ning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jv_ning">Jason Venner (www.prohadoop.com)</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12754648"><td bgcolor="#ffffff">
            <p>Readme for the patch.</p>
        </td></tr>
                <tr id="comment-header-12758989"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">24/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12758989"><td bgcolor="#ffffff">
            <p>Here's a new patch, with log jar dependencies.  </p>

<p>The heartbeat is improved, and there's a queuing mechanism that can result in faster execution times.</p>
        </td></tr>
                <tr id="comment-header-12759189"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">24/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12759189"><td bgcolor="#ffffff">
            <p>An additional required library for the latest patch.</p>
        </td></tr>
                <tr id="comment-header-12760309"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">28/Sep/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12760309"><td bgcolor="#ffffff">
            <p>We need to include the schema.xml in the shard stored in HDFS as otherwise we could get confused about which schema the index was built with.  </p>

<p>We don't need include solrconfig in HDFS because it's used to define parameters related to how the index is built.</p>
        </td></tr>
                <tr id="comment-header-12764717"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jv_ning" id="word_commented_jv_ning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jv_ning">Jason Venner (www.prohadoop.com)</a>
                                        <font size="-2">
            [
                <font color="#336699">12/Oct/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12764717"><td bgcolor="#ffffff">
            <p>I need to update this patch, there is an error in the close method that<br/>
cause timeouts to occur.</p>

<p>Basically, the two lines in the close method need to be changed form, there<br/>
is still the possibility of close happening too early in the rare use cases,<br/>
which is why I haven't updated the patch.<br/>
Basically close can't proceed until the thread pool is done AND<br/>
batchWriter.executingBatches.get() == 0</p>

<p>From:<br/>
          batchWriter.close(reporter, core);<br/>
          heartBeater.needHeartBeat();</p>


<p>To:<br/>
          heartBeater.needHeartBeat();<br/>
          batchWriter.close(reporter, core);</p>





        </td></tr>
                <tr id="comment-header-12764745"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">12/Oct/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12764745"><td bgcolor="#ffffff">
            <p>Thanks for the update Jason.  It runs great, I've generated over a terabyte of indexes using the patch.  Now I'm trying to deploy them, and that's harder!</p>
        </td></tr>
                <tr id="comment-header-12767608"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">20/Oct/09</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12767608"><td bgcolor="#ffffff">
            <p>Here's an update that includes the change Jason mentioned above<br/>
(needHeartBeat in SRW.close). I've run this patch in production,<br/>
however I was unable to turn off logging due to complexities<br/>
with SLF4J layering Hadoop where I could not turn off the Solr<br/>
update logs. I had to comment out the logging lines in Solr to<br/>
insure the Hadoop logs did not fill up. </p>
        </td></tr>
                <tr id="comment-header-12800720"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="gsingers" id="word_commented_gsingers" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gsingers">Grant Ingersoll</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12800720"><td bgcolor="#ffffff">
            <p>Seems like this would make the most sense as a contrib module to Solr.</p>
        </td></tr>
                <tr id="comment-header-12800723"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="gsingers" id="word_commented_gsingers" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gsingers">Grant Ingersoll</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12800723"><td bgcolor="#ffffff">
            <blockquote><p>Furthermore, by using an EmbeddedSolrServer, the indexing task is split into as many parts as there are reducers, and the data to be indexed is not sent over the network.</p></blockquote>

<p>I'm curious about the not sending over the network.  Have you tried the Streaming Server or even just the regular one?  How would this work with someone who already has a separate Solr cluster setup?</p>

<p>Also, I haven't looked closely at the patch, but if I understand correctly, it is writing out the indexes to the local disks on the Hadoop cluster?  </p>
        </td></tr>
                <tr id="comment-header-12800746"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="ab" id="word_commented_ab" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ab">Andrzej Bialecki </a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12800746"><td bgcolor="#ffffff">
            <blockquote><p>I'm curious about the not sending over the network. Have you tried the Streaming Server or even just the regular one?</p></blockquote>

<p>Hmm, I don't think this would make sense - the whole point of this patch is to distribute the load by indexing into multiple Solr instances that use the same config - and this can be an existing user's config including the components from $</p>
{solr.home}
<p>/lib .</p>

<blockquote><p>How would this work with someone who already has a separate Solr cluster setup?</p></blockquote>

<p>It wouldn't - partly because there is no canonical Solr cluster setup against which to code this ... Would that be the same cluster (1:1 mapping) as the Hadoop cluster?</p>

<blockquote><p>Also, I haven't looked closely at the patch, but if I understand correctly, it is writing out the indexes to the local disks on the Hadoop cluster?</p></blockquote>

<p>HDFS doesn't support enough POSIX to support writing Lucene indexes directly to HDFS - for this reason indexes are always created on local storage of each node, and then after closing they are copied to HDFS.</p>
        </td></tr>
                <tr id="comment-header-12800748"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="gsingers" id="word_commented_gsingers" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gsingers">Grant Ingersoll</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12800748"><td bgcolor="#ffffff">
            <blockquote><p>Hmm, I don't think this would make sense - the whole point of this patch is to distribute the load by indexing into multiple Solr instances that use the same config - and this can be an existing user's config including the components from ${solr.home}/lib .</p></blockquote>

<p>Obviously, you would need to have a configuration of Solr indexing servers.  This could easily be obtained from ZK per the other work being done.  Then, the reduce steps just create their SolrServer based on those values and can index directly.  (I realize the ZK stuff didn't exist when you put up this patch.)</p>

<blockquote><p>HDFS doesn't support enough POSIX to support writing Lucene indexes directly to HDFS - for this reason indexes are always created on local storage of each node, and then after closing they are copied to HDFS.</p></blockquote>

<p>Right, and then copied down from HDFS and installed in Solr, correct?  You still have the issue of knowing which Solr instances get which shards off of HDFS, right?  Just seems like a little more configuration knowledge could alleviate all that extra copying/installing, etc.</p>
        </td></tr>
                <tr id="comment-header-12800756"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12800756"><td bgcolor="#ffffff">
            <p>Andrzej's model works great in production. We have both 1)<br/>
master -&gt; slave for incremental updates, and 2) index in Hadoop<br/>
with this patch, we then deploy each new core/shard in a<br/>
balanced fashion to many servers. They're two separate<br/>
modalities. The ZK stuff (as it's modeled today) isn't useful<br/>
here, because I want the schema I indexed with as a part of the<br/>
zip file stored in HDFS (or S3, or wherever). </p>

<p>Any sort of ZK thingy is good for managing the core/shards<br/>
across many servers, however Katta does this already (so we're<br/>
either reinventing the same thing, not necessarily a bad thing<br/>
if we also have a clear path for incremental indexing, as<br/>
discussed above). Ultimately, the Solr server can be viewed as<br/>
simply a container for cores, and the cloud + ZK branch as a<br/>
manager of cores/shards. Anything more ambitious will probably<br/>
be overkill, and this is what I believe Ted has been trying to get at.</p>
        </td></tr>
                <tr id="comment-header-12800758"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="ab" id="word_commented_ab" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ab">Andrzej Bialecki </a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12800758"><td bgcolor="#ffffff">
            <p>Iff we somehow could get a mapping between a mapred task on node X  to a particular target Solr server (beyond the two obvious choices, ie. single URL for one Solr, or localhost for per-node Solr-s) then sure why not. And you are right that we wouldn't use the embedded Solr in that case. But this patch solves a different problem, and it solves it within the facilities of the current config <img class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/wink.gif" height="16" width="16" align="absmiddle" alt="" border="0"/></p>

<blockquote><p>Right, and then copied down from HDFS and installed in Solr, correct? You still have the issue of knowing which Solr instances get which shards off of HDFS, right? Just seems like a little more configuration knowledge could alleviate all that extra copying/installing, etc.</p></blockquote>

<p>Yes. But that would be a completely different scenario - we could wrap it in a Hadoop OutputFormat as well, but the implementation would be totally different from this patch.</p>
        </td></tr>
                <tr id="comment-header-12800760"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="gsingers" id="word_commented_gsingers" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gsingers">Grant Ingersoll</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12800760"><td bgcolor="#ffffff">
            <p>Don't confuse the ZK stuff for search w/ the indexing side.  Using ZK was just an example of a way to get the list of Solr indexing nodes.  What I meant was the Hadoop job could simply know what the set of master indexers are and send the documents directly to them.  Then the slaves simply pull the replications from there.  It all works with existing capabilities instead of the need for scritps, etc. to pull shards down, etc.</p>
        </td></tr>
                <tr id="comment-header-12800775"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12800775"><td bgcolor="#ffffff">
            <blockquote><p>What I meant was the Hadoop job could simply know what<br/>
the set of master indexers are and send the documents directly<br/>
to them</p></blockquote>

<p>One can use Hadoop for this purpose, we have implemented the<br/>
system in this way for the incremental indexes, however it<br/>
doesn't require a separate patch or contrib module. The problem<br/>
with the Hadoop streaming model is it doesn't scale well, if for<br/>
example, we need to reindex using the CJKAnalyzer, or using<br/>
Basis' analyzer etc. We use <a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a> for reindexing loads of<br/>
data, as fast as possible by parallelizing the indexing. There<br/>
are lots of little things I'd like to add to the functionality,<br/>
though, implementing ZK based core management takes a higher<br/>
priority, as I spend a lot of time doing this manually today.</p>
        </td></tr>
                <tr id="comment-header-12800785"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="gsingers" id="word_commented_gsingers" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gsingers">Grant Ingersoll</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12800785"><td bgcolor="#ffffff">
            <p>I don't follow how sending docs to a suite of master indexers prevents incremental (re)indexing or any of the analyzers.  Those are all on the Solr side, not Hadoop.  BTW, I'm not talking about "Hadoop Streaming", just the notion of Hadoop streaming the output of the reduce tasks to the Solr indexing servers.</p>
        </td></tr>
                <tr id="comment-header-12800802"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12800802"><td bgcolor="#ffffff">
            <blockquote><p>Hadoop streaming the output of the reduce tasks to the Solr</p></blockquote>
<p>indexing servers. </p>

<p>Yes, this is what we've implemented, it's just normal Solr HTTP<br/>
based indexing, right? It works well to a limited degree, and<br/>
for the particular implementation details, there are reasons why<br/>
this can be less than ideal. The balanced, distributed<br/>
shards/cores system works far better and enables us to use less<br/>
hardware (but I'm not going into all the details here). </p>

<p>One issue I can mention, is the switch over to a new set of<br/>
incremental servers (which happens then the old servers fill<br/>
up), I'm looking to automate this, and will likely focus on it<br/>
and the core management in the cloud branch. </p>
        </td></tr>
                <tr id="comment-header-12802526"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">19/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12802526"><td bgcolor="#ffffff">
            <p>I started on the Solr wiki page for this guy...</p>

<p><a href="http://wiki.apache.org/solr/HadoopIndexing" class="external-link" rel="nofollow">http://wiki.apache.org/solr/HadoopIndexing</a></p>

        </td></tr>
                <tr id="comment-header-12806538"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kevinpet" id="word_commented_kevinpet" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kevinpet">Kevin Peterson</a>
                                        <font size="-2">
            [
                <font color="#336699">29/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12806538"><td bgcolor="#ffffff">
            <p>As written, this constructs a path relative to the local directories, which is not automatically cleaned up by Hadoop, line 942 in the patch, the constructor for SolrRecordWriter. If this is changed to something like</p>

<p>temp = new Path(job.getWorkingDirectory(), "solr/_" + job.get("mapred.task.id") + '.' + sequence.incrementAndGet() + '.' + perm.getName());</p>

<p>this will be in the tasks working directory and automatically cleaned up on exit. I've checked with #hadoop and the consensus seems to be that this will be cleaned up unless the TT dies.</p>
        </td></tr>
                <tr id="comment-header-12806547"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="tdunning" id="word_commented_tdunning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tdunning">Ted Dunning</a>
                                        <font size="-2">
            [
                <font color="#336699">29/Jan/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12806547"><td bgcolor="#ffffff">
            
<p>It is critical to put indexes in the task local area on both local and hdfs storage areas not just because of task cleanup, but also because a task may be run more than once.  Hadoop handles all the race conditions that would otherwise happen as a result.</p>
        </td></tr>
                <tr id="comment-header-12827997"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">01/Feb/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12827997"><td bgcolor="#ffffff">
            <p>This update include's Kevin's recommended path change....</p>
        </td></tr>
                <tr id="comment-header-12828172"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">01/Feb/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12828172"><td bgcolor="#ffffff">
            <p>There's a bug caused by the latest change:</p>
<blockquote>
<p>java.io.IOException: java.lang.IllegalArgumentException: Wrong FS: hdfs://mi-prod-app01.ec2.biz360.com:9000/user/hadoop/solr/_attempt_201001212110_2841_r_000001_0.1.index-a, expected: <a href="file:///" class="external-link" rel="nofollow">file:///</a><br/>
at org.apache.solr.hadoop.SolrRecordWriter.close(SolrRecordWriter.java:371)<br/>
at com.biz360.mi.index.hadoop.HadoopIndexer$ArticleReducer.reduce(HadoopIndexer.java:147)<br/>
at com.biz360.mi.index.hadoop.HadoopIndexer$ArticleReducer.reduce(HadoopIndexer.java:103)<br/>
at org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:463)<br/>
at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:411)<br/>
at org.apache.hadoop.mapred.Child.main(Child.java:170)<br/>
Caused by: java.lang.IllegalArgumentException: Wrong FS: hdfs://mi-prod-app01.ec2.biz360.com:9000/user/hadoop/solr/_attempt_201001212110_2841_r_000001_0.1.index-a, expected: <a href="file:///" class="external-link" rel="nofollow">file:///</a><br/>
at org.apache.hadoop.fs.FileSystem.checkPath(FileSystem.java:305)<br/>
at org.apache.hadoop.fs.RawLocalFileSystem.pathToFile(RawLocalFileSystem.java:47)<br/>
at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:357)<br/>
at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:245)<br/>
at org.apache.solr.hadoop.SolrRecordWriter.zipDirectory(SolrRecordWriter.java:459)<br/>
at org.apache.solr.hadoop.SolrRecordWriter.packZipFile(SolrRecordWriter.java:390)<br/>
at org.apache.solr.hadoop.SolrRecordWriter.close(SolrRecordWriter.java:362)<br/>
... 5 more </p></blockquote>
        </td></tr>
                <tr id="comment-header-12828232"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kaykay.unique" id="word_commented_kaykay.unique" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kaykay.unique">Karthik K</a>
                                        <font size="-2">
            [
                <font color="#336699">01/Feb/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12828232"><td bgcolor="#ffffff">
            <p>Did the latest patch involve an upgrade of the hdfs / patched hdfs running ? If there were a change - was the fs migration script run to upgrade the file system being referenced ? </p>

<p>Also - what version of hdfs is being used ?Would that be 0.19.1 . </p>

<p>In the roadmap is to release 0.20.2 of hadoop very soon. Of particular interest in that would be <a href="https://issues.apache.org/jira/browse/HDFS-127" title="DFSClient block read failures cause open DFSInputStream to become unusable" class="issue-link" data-issue-key="HDFS-127"><del>HDFS-127</del></a>  , to recover (gracefully) from failed reads.</p>
        </td></tr>
                <tr id="comment-header-12828356"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kevinpet" id="word_commented_kevinpet" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kevinpet">Kevin Peterson</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Feb/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12828356"><td bgcolor="#ffffff">
            <p>I pointed you in the wrong direction. It isn't getWorkingDirectory. I'm trying to find the standard way to get to $</p>
{mapred.local.dir}
<p>/taskTracker/jobcache/$jobid/$taskid or construct a Path using the current working directory, but I'm having trouble making sense of which directories refer to local and which to HDFS.</p>
        </td></tr>
                <tr id="comment-header-12828368"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Feb/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12828368"><td bgcolor="#ffffff">
            <p>I'm testing deleting the temp dir in SRW.close finally...</p>
        </td></tr>
                <tr id="comment-header-12828667"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Feb/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12828667"><td bgcolor="#ffffff">
            <p>I added the following to the SRW.close method's finally clause:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
FileUtils.forceDelete(<span class="code-keyword">new</span> File(temp.toString()));
</pre>
</div></div>
        </td></tr>
                <tr id="comment-header-12828915"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="shyjuthomas" id="word_commented_shyjuthomas" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shyjuthomas">shyjuThomas</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Feb/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12828915"><td bgcolor="#ffffff">
            <p>I have a need to perform Solr indexing in MapReduce task, to achive parallelism. I have noticed 2 Jira issues related to that: <a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a> &amp; <a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>. </p>

<p>I have tried out the patches available with both the issues, and my observation is given below:<br/>
1. The <a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a> patch, performs  input-record to key-value conversion in Map phase; Hadoop (key, value) to SolrInputDocument conversion and the actual indexing will happen in the Reduce phase.<br/>
Meanwhile, <a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a> patch performs the record-to-Doc conversion and the actual indexing in the Map phase; User can make use of the Reducer to perform merging of multiple indices (if required). In another way we can configure the number of reducers as same as the number of Shards. <br/>
2. The <a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a> patch doesn't supports merging of the indices, while <a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a> patch supports.<br/>
3. As per <a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a> patch, no big activity happens in the Map phase (only input-record to key-value conversion). Most of the heavy jobs (esp. the indexing) are happening in the Reduce phase. If we need the final output as a single index, we can use only one reducer, which means bottleneck at Reducer &amp; almost the whole operation happens non-paralelly. <br/>
                       But the case is different with <a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a> patch. It achieves better parallelism when the number of map tasks is greater than the number of reduce tasks, which is usually the case.</p>

<p>Based on these observation, I have few questions. (I am a beginner to the Hadoop &amp; Solr world. So, please forgive me if my questions are silly):<br/>
1. As per above observation, <a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a> patch is functionally better (performance I have not verified yet ). Can anyone tell me, whats the actual advantage <a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a> patch offers over <a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a> patch?<br/>
2. If both the jira issues are trying to solve the same problem, do we really need 2 separate issues?</p>

<p>NOTE : I felt this Jira issue is more active than <a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a>. Thats why I posted my comment here.</p>
        </td></tr>
                <tr id="comment-header-12828961"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="tdunning" id="word_commented_tdunning" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tdunning">Ted Dunning</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Feb/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12828961"><td bgcolor="#ffffff">
            <blockquote>
<p>Based on these observation, I have few questions. (I am a beginner to the Hadoop &amp; Solr world. So, please forgive me if my questions are silly):<br/>
1. As per above observation, <a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a> patch is functionally better (performance I have not verified yet ). Can anyone tell me, whats the actual advantage <a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a> patch offers over <a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a> patch?<br/>
2. If both the jira issues are trying to solve the same problem, do we really need 2 separate issues?</p></blockquote>

<p>In the katta community, the recommended practice started with <a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a> (what I call map-side indexing) behavior, but I think that the consensus now is that <a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a> behavior (what I call reduce side indexing) is much, much better.  This is not necessarily the obvious result given your observations.  There are some operational differences between katta and SOLR that might make the conclusions different, but what I have observed is the following:</p>

<p>a) index merging is a really bad idea that seems very attractive to begin with because it is actually pretty expensive and doesn't solve the real problems of bad document distribution across shards.  It is much better to simply have lots of shards per machine (aka micro-sharding) and use one reducer per shard.  For large indexes, this gives entirely acceptable performance.  On a pretty small cluster, we can index 50-100 million large documents in multiple ways in 2-3 hours.  Index merging gives you no benefit compared to reduce side indexing and just increases code complexity.</p>

<p>b) map-side indexing leaves you with indexes that are heavily skewed by being composed of of documents from a single input split.  At retrieval time, this means that different shards have very different term frequency profiles and very different numbers of relevant documents.  This makes lots of statistics very difficult including term frequency computation, term weighting and determining the number of documents to retrieve.  Map-side merge virtually guarantees that you have to do two cluster queries, one to gather term frequency statistics and another to do the actual query.  With reduce side indexing, you can provide strong probabilistic bounds on how different the statistics in each shard can be so you can use local term statistics and you can depend on the score distribution being this same which radically decreases the number of documents you need to retrieve from each shard.</p>

<p>c) reduce-side indexing improves the balance of computation during retrieval.  If (as is the rule) some document subset is hotter than other document subset due, say to data-source boosting or recency boosting, you will have very bad cluster utilization with skewed shards from map-side indexing while all shards will cost about the same for any query leading to good cluster utilization and faster queries with reduce-side indexing.</p>

<p>d) with reduce-side indexing has properties that can be mathematically stated and proved.  Map-side indexing only has comparable properties if you make unrealistic assumptions about your original data.</p>

<p>e) micro-sharding allows very simple and very effective use of multiple cores on multiple machines in a search cluster.  This can be very difficult to do with large shards or a single index.</p>

<p>Now, as you say, these advantages may evaporate if you are looking to produce a single output index.  That seems, however, to contradict the whole point of scaling.   If you need to scale indexing, presumably you also need to scale search speed and throughput.  As such you probably want to have many shards rather than few.  Conversely, if you can stand to search a single index, then you probably can stand to index on a single machine. </p>

<p>Another thing to think about is the fact SOLR doesn't yet do micro-sharding or clustering very well and, in particular, doesn't handle multiple shards per core.  That will be changing before long, however, and it is very dangerous to design for the past rather than the future.</p>

<p>In case, you didn't notice, I strongly suggest you stick with reduce-side indexing.</p>
        </td></tr>
                <tr id="comment-header-12829200"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Feb/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12829200"><td bgcolor="#ffffff">
            <p>In production the latest patch does not leave temporary files behind... Though before we had failed tasks, so perhaps there's still a bug, we won't know until we run out of disk space again.</p>
        </td></tr>
                <tr id="comment-header-12833108"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">12/Feb/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12833108"><td bgcolor="#ffffff">
            <p>There still seems to be a bug where the temporary directory index isn't deleted on job completion.</p>
        </td></tr>
                <tr id="comment-header-12859838"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="mrevelle" id="word_commented_mrevelle" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mrevelle">Matt Revelle</a>
                                        <font size="-2">
            [
                <font color="#336699">22/Apr/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12859838"><td bgcolor="#ffffff">
            <p>Hi, Jason, I noticed a few problems with the latest patch and am working on the fixes. On SolrRecordWriter:L373, FileUtils.forceDelete is called but prior to this the path dir to delete may have been moved. The move happens when the output isn't a zip file, at line 364 with a call to FileSystem#completeLocalOutput. </p>

<p>Less important, the ls process, which runs when logging is set to the debug level (SolrRecordWriter:L278, appears to not always exit properly and throws an exception.</p>
        </td></tr>
                <tr id="comment-header-12859853"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">22/Apr/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12859853"><td bgcolor="#ffffff">
            <p>Matt, interesting.  I'm most concerned about the left over files, which is still an issue.  In production I use a script that deletes the left overs, which isn't ideal but works.  I'm not sure if the SolrRecordWriter:L373 bug is related to that, I'm always zipping the indexes into HDFS.  </p>
        </td></tr>
                <tr id="comment-header-12861621"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">28/Apr/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12861621"><td bgcolor="#ffffff">
            <p>This is the version of the patch rewritten to use the new mapreduce API in hadoop 0.20. I did a quick port of the patch from 2010-02-02 11:57 AM without any optimizations, just to make it work with a new syntax. There are some slight changes around local filesystem temp file name generation etc. The CSVReducer class added just to pass a proper context to use counters in BatchWriter, if you know the better way to do this, please let me know. Tested with hadoop 0.20.2 on csv data, with both compressed and non-compressed output; seems to be OK, but no extensive regression testing performed. Code review and suggestions/corrections are welcome. </p>
        </td></tr>
                <tr id="comment-header-12861641"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="mrevelle" id="word_commented_mrevelle" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mrevelle">Matt Revelle</a>
                                        <font size="-2">
            [
                <font color="#336699">28/Apr/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12861641"><td bgcolor="#ffffff">
            <p>Updated the latest patch to include a check for the temp file before calling FileUtils.forceDelete.</p>
        </td></tr>
                <tr id="comment-header-12864593"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">06/May/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12864593"><td bgcolor="#ffffff">
            <p>Matt, Can you post a patch including the contrib directory structure (and build.xml)?  </p>
        </td></tr>
                <tr id="comment-header-12864604"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">06/May/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12864604"><td bgcolor="#ffffff">
            <p>Matt, nevermind, I'm just using the patch as is (ie, as a part of Solr core).</p>
        </td></tr>
                <tr id="comment-header-12864606"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="mrevelle" id="word_commented_mrevelle" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mrevelle">Matt Revelle</a>
                                        <font size="-2">
            [
                <font color="#336699">06/May/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12864606"><td bgcolor="#ffffff">
            <p>Jason, Ok.  =)</p>
        </td></tr>
                <tr id="comment-header-12869962"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="viktorsr" id="word_commented_viktorsr" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=viktorsr">Viktors Rotanovs</a>
                                        <font size="-2">
            [
                <font color="#336699">21/May/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12869962"><td bgcolor="#ffffff">
            <p>It looks like when converter returns only 1 document, which is the most common case, number of batches will be equal to number of documents. In earlier version of this patch documents were accumulated and then sent as a batch, and this is what a comment in SolrRecordWriter still says.</p>
        </td></tr>
                <tr id="comment-header-12869977"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="mattrepl" id="word_commented_mattrepl" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mattrepl">Matt Revelle</a>
                                        <font size="-2">
            [
                <font color="#336699">21/May/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12869977"><td bgcolor="#ffffff">
            <p>Viktors: That must have been a regression from Alexander's patch to support the newer Hadoop API.  I may have a chance to investigate today.  If anyone else takes it on, please leave a comment.</p>
        </td></tr>
                <tr id="comment-header-12872607"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="hossman" id="word_commented_hossman" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman">Hoss Man</a>
                                        <font size="-2">
            [
                <font color="#336699">27/May/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12872607"><td bgcolor="#ffffff">
            <p>Bulk updating 240 Solr issues to set the Fix Version to "next" per the process outlined in this email...</p>

<p><a href="http://mail-archives.apache.org/mod_mbox/lucene-dev/201005.mbox/%3Calpine.DEB.1.10.1005251052040.24672@radix.cryptio.net%3E" class="external-link" rel="nofollow">http://mail-archives.apache.org/mod_mbox/lucene-dev/201005.mbox/%3Calpine.DEB.1.10.1005251052040.24672@radix.cryptio.net%3E</a></p>

<p>Selection criteria was "Unresolved" with a Fix Version of 1.5, 1.6, 3.1, or 4.0.  email notifications were suppressed.</p>

<p>A unique token for finding these 240 issues in the future: hossversioncleanup20100527</p>
        </td></tr>
                <tr id="comment-header-12872882"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="otis" id="word_commented_otis" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=otis">Otis Gospodnetic</a>
                                        <font size="-2">
            [
                <font color="#336699">28/May/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12872882"><td bgcolor="#ffffff">
            <p>I see comments and patches adding support for newer versions of Hadoop.  But has anyone used these patches with Elastic Map Reduce (EMR) on EC2?</p>
        </td></tr>
                <tr id="comment-header-12873577"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="koji" id="word_commented_koji" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=koji">Koji Sekiguchi</a>
                                        <font size="-2">
            [
                <font color="#336699">31/May/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12873577"><td bgcolor="#ffffff">
            <p>We are using this patch (Andrzej version + custom code) for our several projects. It works great but sometimes we get OOM when indexing new input data and the data include unexpected large records. I think it is worthy if SolrRecordWriter could have bufferSizeMB (like IndexWriter) to flush buffered docs rather than batchSize basis. Thought?</p>
        </td></tr>
                <tr id="comment-header-12875819"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">05/Jun/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12875819"><td bgcolor="#ffffff">
            <p>Matt, I think Viktors mentioned the original batching logic eliminated by Jason (see his comment from 10/Sep/09 02:46 PM)</p>
        </td></tr>
                <tr id="comment-header-12875949"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">05/Jun/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12875949"><td bgcolor="#ffffff">
            <blockquote><p>Matt, I think Viktors mentioned the original batching logic eliminated by Jason (see his comment from 10/Sep/09 02:46 PM) </p></blockquote>

<p>Right, I don't think we need batching because no efficiency will be gained (ie, there's no network overhead being eliminated).</p>
        </td></tr>
                <tr id="comment-header-12896514"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="tolot27" id="word_commented_tolot27" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tolot27">Mathias Walter</a>
                                        <font size="-2">
            [
                <font color="#336699">09/Aug/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12896514"><td bgcolor="#ffffff">
            <p>I tried this patch with Hadoop 0.20.2. It works pretty well, except if speculative execution is enabled (at least for the reducer). If that is the case, some jobs are running twice. The first job is creating the zip file. The second tries this too and failed. Unfortunately, the first job also fails. I've added a fs.exists(perm) to the SolrRecordWriter.packZipFile method, but the first job still fails with the following exception right after the last write and at nearly the same time the other job tests the existence of the zip file:</p>

<p>2010-08-06 15:35:33,883 INFO com.excerbt.mapreduce.solrindexing.SolrRecordWriter: RawPath /hadoop/hdfs5/tmp/solr_attempt_201007231114_0068_r_000001_0.1/data/index/_4.frq, baseName part-00001, root /hadoop/hdfs5/tmp/solr_attempt_201007231114_0068_r_000001_0.1, inZip 2 part-00001/data/index/_4.frq<br/>
2010-08-06 15:35:36,164 ERROR com.excerbt.mapreduce.solrindexing.SolrRecordWriter: packZipFile exception {}<br/>
java.io.IOException: Filesystem closed<br/>
	at org.apache.hadoop.hdfs.DFSClient.checkOpen(DFSClient.java:230)<br/>
	at org.apache.hadoop.hdfs.DFSClient.access$600(DFSClient.java:65)<br/>
	at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.writeChunk(DFSClient.java:3058)<br/>
	at org.apache.hadoop.fs.FSOutputSummer.writeChecksumChunk(FSOutputSummer.java:150)<br/>
	at org.apache.hadoop.fs.FSOutputSummer.write1(FSOutputSummer.java:100)<br/>
	at org.apache.hadoop.fs.FSOutputSummer.write(FSOutputSummer.java:86)<br/>
	at org.apache.hadoop.fs.FSDataOutputStream$PositionCache.write(FSDataOutputStream.java:49)<br/>
	at java.io.DataOutputStream.write(DataOutputStream.java:90)<br/>
	at java.util.zip.DeflaterOutputStream.deflate(DeflaterOutputStream.java:161)<br/>
	at java.util.zip.DeflaterOutputStream.write(DeflaterOutputStream.java:118)<br/>
	at java.util.zip.ZipOutputStream.write(ZipOutputStream.java:272)<br/>
	at org.apache.hadoop.io.IOUtils.copyBytes(IOUtils.java:51)<br/>
	at org.apache.hadoop.io.IOUtils.copyBytes(IOUtils.java:87)<br/>
	at com.excerbt.mapreduce.solrindexing.SolrRecordWriter.zipDirectory(SolrRecordWriter.java:493)<br/>
	at com.excerbt.mapreduce.solrindexing.SolrRecordWriter.zipDirectory(SolrRecordWriter.java:469)<br/>
	at com.excerbt.mapreduce.solrindexing.SolrRecordWriter.zipDirectory(SolrRecordWriter.java:469)<br/>
	at com.excerbt.mapreduce.solrindexing.SolrRecordWriter.zipDirectory(SolrRecordWriter.java:469)<br/>
	at com.excerbt.mapreduce.solrindexing.SolrRecordWriter.packZipFile(SolrRecordWriter.java:385)<br/>
	at com.excerbt.mapreduce.solrindexing.SolrRecordWriter.close(SolrRecordWriter.java:349)<br/>
	at org.apache.hadoop.mapred.ReduceTask.runNewReducer(ReduceTask.java:567)<br/>
	at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:408)<br/>
	at org.apache.hadoop.mapred.Child.main(Child.java:170)</p>

<p>That's really strange. I checked this for many jobs. Also, the incomplete zip file is not removed after this exception.</p>
        </td></tr>
                <tr id="comment-header-12897507"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">12/Aug/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12897507"><td bgcolor="#ffffff">
            <p>Mathias, I did not test the patch for 0.20 with speculative execution for the reducers; but it is probably failing because the other task attempt deletes the perm file  (see SolrRecordWriter constructor, there is a cleanup fs.delete(perm, true) call after constructing the perm Path). </p>

<p>If you really need the speculative execution for the reducers, you could try to use the Reducer context to construct the perm file using the getWorkOutputPath instead of getOutputPath() (in this case, if the particular attempt was successful then its perm file should be promoted to the task work dir automatically - see that side effect explanation here: <a href="http://hadoop.apache.org/common/docs/r0.20.2/api/org/apache/hadoop/mapreduce/lib/output/FileOutputFormat.html#getWorkOutputPath%28org.apache.hadoop.mapreduce.TaskInputOutputContext%29" class="external-link" rel="nofollow">http://hadoop.apache.org/common/docs/r0.20.2/api/org/apache/hadoop/mapreduce/lib/output/FileOutputFormat.html#getWorkOutputPath%28org.apache.hadoop.mapreduce.TaskInputOutputContext%29</a>), </p>

<p>i.e. instead of </p>

<p>perm = new Path(FileOutputFormat.getOutputPath(context), getOutFileName(context, "part"));</p>

<p>try to use something like this:</p>

<p>Reducer.Context rContext = contextMap.get(context.getTaskAttemptID().getTaskID());<br/>
perm = new Path(FileOutputFormat.getWorkOutputPath(rContext), getOutFileName(context, "part"));</p>
        </td></tr>
                <tr id="comment-header-12902645"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="daniel.pizarro" id="word_commented_daniel.pizarro" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daniel.pizarro">Daniel Ivan Pizarro</a>
                                        <font size="-2">
            [
                <font color="#336699">25/Aug/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12902645"><td bgcolor="#ffffff">
            <p>I'm getting the following error:</p>

<p>java.lang.IllegalStateException: Failed to initialize record writer for , attempt_local_0001_r_000000_0</p>


<p>Where can I find instructions to run the CVSUploader?</p>

<p>(readme file says "Please read the original patch readme for details on the CSV bulk uploader.", and I can't find that readme file)</p>
        </td></tr>
                <tr id="comment-header-12907267"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="gsingers" id="word_commented_gsingers" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gsingers">Grant Ingersoll</a>
                                        <font size="-2">
            [
                <font color="#336699">08/Sep/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12907267"><td bgcolor="#ffffff">
            <p>I think this should be a contrib module.  Alexander, would you be willing to update it to trunk and make it a Solr contrib?</p>
        </td></tr>
                <tr id="comment-header-12907347"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">08/Sep/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12907347"><td bgcolor="#ffffff">
            <p>Grant, sure. Will do this in a next couple of days. </p>
        </td></tr>
                <tr id="comment-header-12912393"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">20/Sep/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12912393"><td bgcolor="#ffffff">
            <p>The latest 0.20 patch is repackaged to be placed under the contrib, as it was initially (build.xml is included). and tested against the current trunk. As usual, after applying the patch put the 4 lib jars (hadoop, log4j, and two commons-logging) to the contrib/hadoop/lib. No unit tests as for now <img class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/smile.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> but I hope to add some soon. Here is the big question: as Andrzej once mentioned, the unit tests require a running Hadoop cluster. One approach is to make the patch and unit tests working with the Hadoop mini--cluster (ClusterMapReduceTestCase), however this will bring some extra dependencies needed to run the cluster (like jetty). Another idea is to use "your own" cluster and just configure access to this cluster in untt tests; this approach seems to be logical but potentially may give different test results on different clusters, and also may not give some low-level access to the execution, needed for tests. So what is your opinion on how the tests for solr-hadoop should be run? I am not really happy with the idea of starting and running the Hadoop cluster while performing the Solr unit tests, but this still could be the better option than no unit tests at all.  </p>
        </td></tr>
                <tr id="comment-header-12912497"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jasonrutherglen" id="word_commented_jasonrutherglen" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonrutherglen">Jason Rutherglen</a>
                                        <font size="-2">
            [
                <font color="#336699">20/Sep/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12912497"><td bgcolor="#ffffff">
            <p>Alexander,</p>

<p>I think we'll need to use Hadoop's Mini Cluster in order to have a proper unit test.  Adding Jetty as a dependency shouldn't be too much of a problem as Solr already includes a small version of Jetty?  That being said, it doesn't mean it's fun to write the unit test.  I can assist if needed.</p>
        </td></tr>
                <tr id="comment-header-12920402"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="dhruvbansal" id="word_commented_dhruvbansal" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dhruvbansal">Dhruv Bansal</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Oct/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12920402"><td bgcolor="#ffffff">
            <p>I am unable to compile SOLR 1.4.1 after patching with the latest (2010-09-20 04:40 AM) <a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>.patch.</p>

<div class="code panel" style="border-style: solid;border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
$ wget http:<span class="code-comment">//mirror.cloudera.com/apache//lucene/solr/1.4.1/apache-solr-1.4.1.tgz
</span>...
$ tar -xzf apache-solr-1.4.1.tgz
$ cd apache-solr-1.4.1/contrib
apache-solr-1.4.1/contrib$ wget https:<span class="code-comment">//issues.apache.org/jira/secure/attachment/12455023/SOLR-1301.patch
</span>apache-solr-1.4.1/contrib$ patch -p2 -i SOLR-1301.patch
...
apache-solr-1.4.1/contrib$ mkdir lib
apache-solr-1.4.1/contrib$ cd lib
apache-solr-1.4.1/contrib/lib$ wget .. # download hadoop, log4j, commons-logging, commons-logging-api jars from top of <span class="code-keyword">this</span> page
...
apache-solr-1.4.1/contrib/lib$ cd ../..
apache-solr-1.4.1$ ant dist -k

...

compile:
    [javac] Compiling 9 source files to /home/dhruv/projects/infochimps/search/apache-solr-1.4.1/contrib/hadoop/build/classes
Target 'compile' failed with message 'The following error occurred <span class="code-keyword">while</span> executing <span class="code-keyword">this</span> line:
/home/dhruv/projects/infochimps/search/apache-solr-1.4.1/common-build.xml:159: Reference lucene.classpath not found.'.
Cannot execute 'build' - 'compile' failed or was not executed.
Cannot execute 'dist' - 'build' failed or was not executed.
   [subant] File '/home/dhruv/projects/infochimps/search/apache-solr-1.4.1/contrib/hadoop/build.xml' failed with message 'The following error occurred whil\
e executing <span class="code-keyword">this</span> line:
   [subant] /home/dhruv/projects/infochimps/search/apache-solr-1.4.1/contrib/hadoop/build.xml:65: The following error occurred <span class="code-keyword">while</span> executing <span class="code-keyword">this</span> line:
   [subant] /home/dhruv/projects/infochimps/search/apache-solr-1.4.1/common-build.xml:159: Reference lucene.classpath not found.'.

....
</pre>
</div></div> 

<p>Am I following the procedure properly?  I'm able to build SOLR just fine out of the box as well as after applying <a href="https://issues.apache.org/jira/browse/SOLR-1395" class="external-link" rel="nofollow">SOLR-1395</a>.</p>
        </td></tr>
                <tr id="comment-header-12922329"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">18/Oct/10</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12922329"><td bgcolor="#ffffff">
            <p>Dhruv, thank you, I overlooked this reference. To fix the issue, please go to the build.xml in contrib/hadoop folder and delete the line "&lt;path refid="lucene.classpath"/&gt;" - or just download the new version of the patch (attached). You followed the procedure properly except that the hadoop and logging jars are supposed to go to the contrib/hadoop/lib, not the contrib/lib.</p>
        </td></tr>
                <tr id="comment-header-12981930"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">14/Jan/11</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-12981930"><td bgcolor="#ffffff">
            <p>Note for the Hadoop 0.21 users: the current patch can be used "as is" with 0.21, but you will need to make sure to compile it with appropriate jars (hadoop-common-0.21.0.jar and hadoop-mapred-0.21.0.jar instead of hadoop-0.20.x-core.jar). Also, as a workaround, I had to put all the relevant jars (solr, solrj etc.) to the lib folder of the job's jar file (i.e.  apache-solr-hadoop-xxx-dev.jar) to avoid InvocationTargetException/ClassNotFound exceptions I did not have with Hadoop 0.20.</p>
        </td></tr>
                <tr id="comment-header-13030586"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="lancenorskog" id="word_commented_lancenorskog" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lancenorskog">Lance Norskog</a>
                                        <font size="-2">
            [
                <font color="#336699">09/May/11</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13030586"><td bgcolor="#ffffff">
            <p>Hadoop contains something called MR, a unit test framework. Is it possible to use that for this purpose?</p>
        </td></tr>
                <tr id="comment-header-13043689"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="rcmuir" id="word_commented_rcmuir" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rcmuir">Robert Muir</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Jun/11</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13043689"><td bgcolor="#ffffff">
            <p>Bulk move 3.2 -&gt; 3.3</p>
        </td></tr>
                <tr id="comment-header-13088829"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markj9" id="word_commented_markj9" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markj9">Mark Johnson</a>
                                        <font size="-2">
            [
                <font color="#336699">22/Aug/11</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13088829"><td bgcolor="#ffffff">
            <p>It appears that this issue has fallen by the wayside.  Is there still a plan to roll this into contrib?  Why has all activity stopped on it?</p>
        </td></tr>
                <tr id="comment-header-13088860"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markj9" id="word_commented_markj9" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markj9">Mark Johnson</a>
                                        <font size="-2">
            [
                <font color="#336699">22/Aug/11</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13088860"><td bgcolor="#ffffff">
            <p>Also does anyone have the json converter listed in the readme?  </p>
        </td></tr>
                <tr id="comment-header-13090429"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">24/Aug/11</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13090429"><td bgcolor="#ffffff">
            <p>Mark, I planned to add some unit tests and the packaging for hadoop 0.21.x but unfortunately had no time for this. The problem with unit tests is that you need to either to use your own external hadoop cluster or to run mini-cluster, both ways do not work well for a Solr contrib module in my opinion. I tried to use MRUnit approach while ago with 0.20.x, without success. Maybe will get back to this and try again with 0.21 but I do not anticipate this until mid of September.  </p>
        </td></tr>
                <tr id="comment-header-13106294"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="rcmuir" id="word_commented_rcmuir" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rcmuir">Robert Muir</a>
                                        <font size="-2">
            [
                <font color="#336699">16/Sep/11</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13106294"><td bgcolor="#ffffff">
            <p>3.4 -&gt; 3.5</p>
        </td></tr>
                <tr id="comment-header-13106900"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="viktorsr" id="word_commented_viktorsr" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=viktorsr">Viktors Rotanovs</a>
                                        <font size="-2">
            [
                <font color="#336699">17/Sep/11</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13106900"><td bgcolor="#ffffff">
            <p>Beware: with ZIP option enabled, this patch probably has 4 GiB limit on entries inside the zip file, because of file format limitation. I was able to generate 6.8 GB zip file with this patch, but unzip -t fails when encountering &gt;10 GB file inside it:</p>

<p>$ unzip -t /tmp/test.zip<br/>
Archive:  /tmp/test.zip<br/>
warning <span class="error">&#91;/tmp/test.zip&#93;</span>:  4294967296 extra bytes at beginning or within zipfile<br/>
  (attempting to process anyway)<br/>
file #1:  bad zipfile offset (local header sig):  4294967296<br/>
  (attempting to re-compensate)<br/>
    testing: part-00000/              OK<br/>
    testing: part-00000/conf/         OK<br/>
    testing: part-00000/conf/schema.xml   OK<br/>
    testing: part-00000/data/         OK<br/>
    testing: part-00000/data/spellchecker/   OK<br/>
    testing: part-00000/data/spellchecker/segments_1   OK<br/>
    testing: part-00000/data/spellchecker/segments.gen   OK<br/>
    testing: part-00000/data/index/   OK<br/>
    testing: part-00000/data/index/_10i.nrm   OK<br/>
    testing: part-00000/data/index/_10i.tii   OK<br/>
    testing: part-00000/data/index/_10i.tis   OK<br/>
    testing: part-00000/data/index/_10i.fnm   OK<br/>
    testing: part-00000/data/index/segments_2   OK<br/>
    testing: part-00000/data/index/_10i.fdx   OK<br/>
    testing: part-00000/data/index/_10i.prx   OK<br/>
    testing: part-00000/data/index/_10i.fdt  <br/>
  error:  invalid compressed data to inflate<br/>
file #17:  bad zipfile offset (local header sig):  1528156471<br/>
  (attempting to re-compensate)<br/>
    testing: part-00000/data/index/_10i.frq</p>
        </td></tr>
                <tr id="comment-header-13109190"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">21/Sep/11</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13109190"><td bgcolor="#ffffff">
            <p>Viktors, can you increase the number of reducers to avoid big output files? As for the zip format, the Java 7 seems to support zip64 extensions, alternatively we can add an option to generate jtar'ed output or something similar.</p>
        </td></tr>
                <tr id="comment-header-13155291"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markj9" id="word_commented_markj9" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markj9">Mark Johnson</a>
                                        <font size="-2">
            [
                <font color="#336699">22/Nov/11</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13155291"><td bgcolor="#ffffff">
            <p>Has anyone updated this contrib to work with the new ant tasks in solr 3.4?</p>
        </td></tr>
                <tr id="comment-header-13214100"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">22/Feb/12</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13214100"><td bgcolor="#ffffff">
            <p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a> patch modified to work with Solr 3.x ant build. tested with Solr 3.5.0 and Cloudera CDH3u3 (also attached) </p>
        </td></tr>
                <tr id="comment-header-13214101"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="randy@fixflyer.com" id="word_commented_randy@fixflyer.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=randy%40fixflyer.com">Randy Prager</a>
                                        <font size="-2">
            [
                <font color="#336699">22/Feb/12</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13214101"><td bgcolor="#ffffff">
            <p>I will be out of the office from 2/21 to 2/27 with limited email access.</p>

<p>For immediate inquiries please contact support@fixflyer.com or 888-349-3593.</p>
        </td></tr>
                <tr id="comment-header-13214102"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">22/Feb/12</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13214102"><td bgcolor="#ffffff">
            <p>Note, the hadoop-core-0.20.2-cdh3u3.jar is a part of Cloudera's CDH3 Hadoop distribution and is licensed under Apache License v. 2.0.</p>
        </td></tr>
                <tr id="comment-header-13214152"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">23/Feb/12</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13214152"><td bgcolor="#ffffff">
            <p>OK, so I changed the patch to work with 3.5 ant build and re-tested it with Solr 3.5 and Cloudera's CDH3u3 (both the build and csv test run in pseudo-distributed mode). Still no unit tests but I am working on this <img class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/smile.gif" height="16" width="16" align="absmiddle" alt="" border="0"/></p>

<p>No changes compared to previous version except that I had to comment out the code that sets the debug level dynamically in SolrRecordWriter - because of the conflics with slf4j parts in current Solr; I think it is minor but if not please feel free to resolve this and update the patch. With this done, no need to put the log4j and commons-logging jars in the hadoop/lib at a compile time anymore, only the hadoop jar. I provided the hadoop-core-0.20.2-cdh3u3.jar used for testing as a part of the patch but you can use the other versions of 0.20.x if you'd like; it also should work with hadoop 0.21.x. Note that you still need to make the other related jars (solr, solrj, lucene, commons etc) available while you running your job; one way to do this is to put all the needed jars into the lib subfolder of apache-solr-hadoop jar, another ways are described here: <a href="http://www.cloudera.com/blog/2011/01/how-to-include-third-party-libraries-in-your-map-reduce-job/" class="external-link" rel="nofollow">http://www.cloudera.com/blog/2011/01/how-to-include-third-party-libraries-in-your-map-reduce-job/</a>. </p>

<p>Finally, the quick steps to get the patch compiled (on linux):<br/>
1.  get the solr source tarball (apache-solr-3.5.0-src.tgz in this example), put it into some folder, cd there<br/>
2.  tar -xzf apache-solr-3.5.0-src.tgz<br/>
3.  cd apache-solr-3.5.0/solr<br/>
4.  wget <a href="https://issues.apache.org/jira/secure/attachment/12515662/SOLR-1301.patch" class="external-link" rel="nofollow">https://issues.apache.org/jira/secure/attachment/12515662/SOLR-1301.patch</a><br/>
5.  patch -p0 -i <a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>.patch<br/>
6.  mkdir contrib/hadoop/lib<br/>
7.  cd contrib/hadoop/lib<br/>
8.  wget <a href="https://issues.apache.org/jira/secure/attachment/12515663/hadoop-core-0.20.2-cdh3u3.jar" class="external-link" rel="nofollow">https://issues.apache.org/jira/secure/attachment/12515663/hadoop-core-0.20.2-cdh3u3.jar</a><br/>
9.  cd ../../..<br/>
10. ant dist</p>

<p>and you should have the apache-solr-hadoop-3.5-SNAPSHOT.jar in solr/dist folder.</p>
        </td></tr>
                <tr id="comment-header-13234660"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="hossman" id="word_commented_hossman" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman">Hoss Man</a>
                                        <font size="-2">
            [
                <font color="#336699">21/Mar/12</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13234660"><td bgcolor="#ffffff">
            <p>Bulk of fixVersion=3.6 -&gt; fixVersion=4.0 for issues that have no assignee and have not been updated recently.</p>

<p>email notification suppressed to prevent mass-spam<br/>
psuedo-unique token identifying these issues: hoss20120321nofix36</p>
        </td></tr>
                <tr id="comment-header-13237738"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="gbowyer@fastmail.co.uk" id="word_commented_gbowyer@fastmail.co.uk" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gbowyer%40fastmail.co.uk">Greg Bowyer</a>
                                        <font size="-2">
            [
                <font color="#336699">25/Mar/12</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13237738"><td bgcolor="#ffffff">
            <p>Updated patch that deals with a minor change post <a href="https://issues.apache.org/jira/browse/SOLR-3204" title="solr-commons-csv must not use the org.apache.commons.csv package" class="issue-link" data-issue-key="SOLR-3204"><del>SOLR-3204</del></a></p>
        </td></tr>
                <tr id="comment-header-13678948"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="otis" id="word_commented_otis" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=otis">Otis Gospodnetic</a>
                                        <font size="-2">
            [
                <font color="#336699">09/Jun/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13678948"><td bgcolor="#ffffff">
            <p>Noticed this is issue #11 in terms of votes and has 50 watchers.<br/>
From the description, this is only about MapReduce-based indexing.</p>

<p>Qs:</p>
<ul>
	<li>Are there plans to make it possible to use Solr as Input for MapReduce?</li>
	<li><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a>, do you know if anything related will be contributed to Solr by Cloudera?</li>
	<li>Is <a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a> a subset of this issue and thus closable?</li>
</ul>

        </td></tr>
                <tr id="comment-header-13679070"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">09/Jun/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13679070"><td bgcolor="#ffffff">
            <p>Yeah, we have taken this issue as a starting point and extended and polished it quite a bit. Wolfgang will provide an initial 'dump' of the work that was done shortly, but there will still be some work integrating it into our build system and trunk.</p>
        </td></tr>
                <tr id="comment-header-13688330"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="kanarsky" id="word_commented_kanarsky" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky">Alexander Kanarsky</a>
                                        <font size="-2">
            [
                <font color="#336699">19/Jun/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13688330"><td bgcolor="#ffffff">
            <p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=otis" class="user-hover" rel="otis">Otis Gospodnetic</a>, do you mean to use the Solr query result as an MapReduce job input?<br/>
Also, regarding the <a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a>, it is a different approach (in Map phase vs. Reduce phase- great explanation by Ted is up here: <a href="https://issues.apache.org/jira/browse/SOLR-1301#comment-12828961" class="external-link" rel="nofollow">https://issues.apache.org/jira/browse/SOLR-1301#comment-12828961</a>)</p>
        </td></tr>
                <tr id="comment-header-13693019"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="otis" id="word_commented_otis" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=otis">Otis Gospodnetic</a>
                                        <font size="-2">
            [
                <font color="#336699">25/Jun/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13693019"><td bgcolor="#ffffff">
            <p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kanarsky" class="user-hover" rel="kanarsky">Alexander Kanarsky</a> - yes, take Solr results and use them for MR input, as well as run a MR job and index into Solr (<a href="https://issues.apache.org/jira/browse/SOLR-1045" title="Build Solr index using Hadoop MapReduce" class="issue-link" data-issue-key="SOLR-1045">SOLR-1045</a>).</p>

        </td></tr>
                <tr id="comment-header-13716621"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">23/Jul/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13716621"><td bgcolor="#ffffff">
            <p>As I mentioned above, Cloudera has a done a lot with moving this issue forward. I've been working on converting the build system from maven to ivy+ant and will post my current progress before long.</p>
        </td></tr>
                <tr id="comment-header-13755612"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">31/Aug/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13755612"><td bgcolor="#ffffff">
            <p>Here is a patch with my current progress.</p>

<p>This is a Solr contrib module that can build Solr indexes in HDFS via MapReduce. It builds upon the Solr support for reading and writing to HDFS.</p>

<p>It supports a GoLive feature that allows merging into a running cluster as the final step of the MapReduce job.</p>

<p>There is fairly comprehensive help documentation as part of the MapReduceIndexerTool.</p>

<p>For ETL, Morphlines from the open source Cloudera CDK is used: <a href="https://github.com/cloudera/cdk/tree/master/cdk-morphlines" class="external-link" rel="nofollow">https://github.com/cloudera/cdk/tree/master/cdk-morphlines</a> This is the same ETL library that the Solr integration with Apache Flume uses.</p>

<p>What I have recently done: updated to latest code, fixed 5x requires solr.xml now, converted maven to ivy+ant, updated license files, fixed validation errors, integrated tests fully into test framework, got tests passing.</p>

<p>All tests are passing with this patch for me, but there are still a variety of issues to address:</p>

<ul>
	<li>run yarn <b>and</b> mr1 - the maven build would run the unit tests against yarn or mr1 depending on the profile chosen on the command line - this patch runs against yarn.</li>
</ul>


<ul>
	<li>The MiniYarnCluster used for unit tests is hard coded to use the 'current-working-dir'/target path. This is a bad and illegal location. For the moment, I've relaxed the Lucene tests policy file to allow read/writes anywhere - this needs to be addressed before committing.</li>
</ul>


<ul>
	<li>We depend on some Morphline commands that depend on Solr - this could cause us problems in the future, and we want to own the code for this commands in Solr I think.</li>
</ul>


<ul>
	<li>There are thread leaks in the tests that should be looked into - some might not be avoidable as in other Hadoop tests (as we wait for fixes from the Hadoop project).</li>
</ul>


<ul>
	<li>We need to sync up with the latest code from the maven version - there have been some changes since this code was extracted.</li>
</ul>


<p>There are a number of new contributors to this issue that I will be sure to enumerate in CHANGES.</p>

<p>I'll add whatever I'm forgetting in a later comment.</p>
        </td></tr>
                <tr id="comment-header-13755613"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">31/Aug/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13755613"><td bgcolor="#ffffff">
            <p>Another thing I have not looked at: The final jar that is created in the dist for the MapReduceIndexerTool - it likely still needs tweaking.</p>
        </td></tr>
                <tr id="comment-header-13755642"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">01/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13755642"><td bgcolor="#ffffff">
            <p>And another note: need to add support for the skip hadoop tests system property as well.</p>
        </td></tr>
                <tr id="comment-header-13763527"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="phanichaitanya" id="word_commented_phanichaitanya" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=phanichaitanya">Phani Chaitanya Vempaty</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13763527"><td bgcolor="#ffffff">
            <p>I wanted to look at the code but after I downloaded solr-4.4.0 and applied the patch, I'm not able to create the eclipse project. It says that there is no ivy.xml in solr-mr directory and it is missing indeed. I created one and now everything is fine. Is ivy.xml missed as it is an initial-cut or am I doing something wrong. Below is my ivy.xml.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml">
<span class="code-tag">&lt;ivy-module version=<span class="code-quote">"2.0"</span>&gt;</span>
    <span class="code-tag">&lt;info organisation=<span class="code-quote">"org.apache.solr"</span> module=<span class="code-quote">"solr-mr"</span>/&gt;</span>
    <span class="code-tag">&lt;dependencies&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"org.apache.hadoop"</span> name=<span class="code-quote">"hadoop-common"</span> rev=<span class="code-quote">"2.0.5-alpha"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"org.apache.hadoop"</span> name=<span class="code-quote">"hadoop-core"</span> rev=<span class="code-quote">"1.2.1"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"org.apache.hadoop"</span> name=<span class="code-quote">"hadoop-hdfs"</span> rev=<span class="code-quote">"2.0.5-alpha"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"org.apache.hadoop"</span> name=<span class="code-quote">"hadoop-mapreduce"</span> rev=<span class="code-quote">"2.0.5-alpha"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"org.apache.hadoop"</span> name=<span class="code-quote">"hadoop-mapreduce-client"</span> rev=<span class="code-quote">"2.0.5-alpha"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"org.apache.hadoop"</span> name=<span class="code-quote">"hadoop-mapreduce-client-core"</span> rev=<span class="code-quote">"2.0.5-alpha"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"org.apache.hadoop"</span> name=<span class="code-quote">"hadoop-mapred"</span> rev=<span class="code-quote">"0.22.0"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"org.apache.hadoop"</span> name=<span class="code-quote">"hadoop-yarn"</span> rev=<span class="code-quote">"2.0.5-alpha"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"com.codahale.metrics"</span> name=<span class="code-quote">"metrics-core"</span> rev=<span class="code-quote">"3.0.1"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"com.cloudera.cdk"</span> name=<span class="code-quote">"cdk-morphlines-core"</span> rev=<span class="code-quote">"0.7.0"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"com.cloudera.cdk"</span> name=<span class="code-quote">"cdk-morphlines-solr-core"</span> rev=<span class="code-quote">"0.7.0"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"org.skife.com.typesafe.config"</span> name=<span class="code-quote">"typesafe-config"</span> rev=<span class="code-quote">"0.3.0"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;dependency org=<span class="code-quote">"net.sourceforge.argparse4j"</span> name=<span class="code-quote">"argparse4j"</span> rev=<span class="code-quote">"0.4.1"</span> transitive=<span class="code-quote">"false"</span>/&gt;</span>
      <span class="code-tag">&lt;exclude org=<span class="code-quote">"*"</span> ext=<span class="code-quote">"*"</span> matcher=<span class="code-quote">"regexp"</span> type=<span class="code-quote">"${ivy.exclude.types}"</span>/&gt;</span>
    <span class="code-tag">&lt;/dependencies&gt;</span>
<span class="code-tag">&lt;/ivy-module&gt;</span>
</pre>
</div></div>

<p>Though at least now I'm able to get the eclipse project to view the code, I still have some compile errors in the project which I guess is mainly due to the hadoop versions that I have in the above ivy.xml file w.r.t hadoop-core and others (I'm not able to find 2.0.5-alpha from <a href="http://repo1.maven.org/maven2/org/apache/hadoop/hadoop-core/" class="external-link" rel="nofollow">http://repo1.maven.org/maven2/org/apache/hadoop/hadoop-core/</a> - I did not look into CDH jars though). I'm also not able to compile the code base after applying this patch due to this very reason.</p>
        </td></tr>
                <tr id="comment-header-13763602"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13763602"><td bgcolor="#ffffff">
            <blockquote><p>Is ivy.xml missed as it is an initial-cut or am I doing something wrong. </p></blockquote>

<p>No, it should be there - not sure why it wouldn't have made it into the patch. I'll post another before long.</p>
        </td></tr>
                <tr id="comment-header-13763618"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13763618"><td bgcolor="#ffffff">
            <p>FYI, One things that's definitely off in that adhoc ivy.xml above is that it should use com.typesafe rather than org.skife.com.typesafe.config. Use version 1.0.2 of it. See <a href="http://search.maven.org/#search%7Cga%7C1%7Ctypesafe-config" class="external-link" rel="nofollow">http://search.maven.org/#search%7Cga%7C1%7Ctypesafe-config</a></p>

<p>Maybe best to wait for Mark to post our full ivy.xml, though. </p>

<p>(Moving all our solr-mr dependencies from Cloudera Search maven to ivy was a bit of a beast). </p>
        </td></tr>
                <tr id="comment-header-13763636"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13763636"><td bgcolor="#ffffff">
            <p>By the way, docs and the downstream code for our solr-mr contrib submission is here: <a href="https://github.com/cloudera/search/tree/master/search-mr" class="external-link" rel="nofollow">https://github.com/cloudera/search/tree/master/search-mr</a></p>

        </td></tr>
                <tr id="comment-header-13763644"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13763644"><td bgcolor="#ffffff">
            <p>This new solr-mr contrib uses morphlines for ETL from MapReduce into Solr. To get started, here are some pointers for morphlines background material and code:</p>

<p>code:</p>

<p>	<a href="https://github.com/cloudera/cdk/tree/master/cdk-morphlines" class="external-link" rel="nofollow">https://github.com/cloudera/cdk/tree/master/cdk-morphlines</a></p>

<p>blog post:</p>

<p>	<a href="http://blog.cloudera.com/blog/2013/07/morphlines-the-easy-way-to-build-and-integrate-etl-apps-for-apache-hadoop/" class="external-link" rel="nofollow">http://blog.cloudera.com/blog/2013/07/morphlines-the-easy-way-to-build-and-integrate-etl-apps-for-apache-hadoop/</a></p>

<p>reference guide:</p>

<p>	<a href="http://cloudera.github.io/cdk/docs/current/cdk-morphlines/morphlinesReferenceGuide.html" class="external-link" rel="nofollow">http://cloudera.github.io/cdk/docs/current/cdk-morphlines/morphlinesReferenceGuide.html</a></p>

<p>slides:</p>

<p>	<a href="http://www.slideshare.net/cloudera/using-morphlines-for-onthefly-etl" class="external-link" rel="nofollow">http://www.slideshare.net/cloudera/using-morphlines-for-onthefly-etl</a></p>

<p>talk recording:</p>

<p>	<a href="http://www.youtube.com/watch?v=iR48cRSbW6A" class="external-link" rel="nofollow">http://www.youtube.com/watch?v=iR48cRSbW6A</a></p>
        </td></tr>
                <tr id="comment-header-13763690"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="phanichaitanya" id="word_commented_phanichaitanya" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=phanichaitanya">Phani Chaitanya Vempaty</a>
                                        <font size="-2">
            [
                <font color="#336699">11/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13763690"><td bgcolor="#ffffff">
            <p>Thanks Wolfgang. I corrected it in my xml, though will be waiting for Mark to give the full version of the xml file.</p>
        </td></tr>
                <tr id="comment-header-13763715"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">11/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13763715"><td bgcolor="#ffffff">
            <p>Here is another patch. No major changes. I've confirmed it has ivy.xml in it.</p>

<p>I made some minor tweaks to fix issues 'precommit' brought up, but it's currently failing on 3 javadoc warnings due to some new hadoop test dependencies:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>  [javadoc] /ssd/workspace3/lucene-solr-5x-mr/solr/contrib/solr-mr/lib/hadoop-mapreduce-client-jobclient-2.0.5-alpha-tests.jar(org/apache/hadoop/mapreduce/TestLocalRunner.class): warning: Cannot find annotation method 'timeout()' in type 'Test': class file for org.junit.Test not found
  [javadoc] /ssd/workspace3/lucene-solr-5x-mr/solr/contrib/solr-mr/lib/hadoop-common-2.0.5-alpha-tests.jar(org/apache/hadoop/util/TestClassUtil.class): warning: Cannot find annotation method 'timeout()' in type 'Test'
  [javadoc] /ssd/workspace3/lucene-solr-5x-mr/solr/contrib/solr-mr/lib/hadoop-common-2.0.5-alpha-tests.jar(org/apache/hadoop/io/TestSortedMapWritable.class): warning: Cannot find annotation method 'timeout()' in type 'Test'
</pre>
</div></div>
        </td></tr>
                <tr id="comment-header-13763718"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">11/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13763718"><td bgcolor="#ffffff">
            <p>Given that my first patch was 963k and the latest is 2.33MB, it seems the first was missing a bunch of things due to me not yet adding them to svn - sorry about that - the latest patch should be complete.</p>
        </td></tr>
                <tr id="comment-header-13763743"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">11/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13763743"><td bgcolor="#ffffff">
            <p>FYI - <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek" class="user-hover" rel="whoschek">wolfgang hoschek</a> and <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=phunt" class="user-hover" rel="phunt">Patrick Hunt</a> are the primary authors of the code - it was based on the initial patches in this issue, but has been heavily processed and expanded. Full unit tests have also been written. <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gchanan" class="user-hover" rel="gchanan">Gregory Chanan</a>, <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rvs" class="user-hover" rel="rvs">Roman Shaposhnik</a>, I, and Eric Wong also contributed thoughts, code, and features. I have not yet added a CHANGES entry to the patch, but this is the current list of authors that would go in, along with the authors of the previous work in this JIRA.</p>
        </td></tr>
                <tr id="comment-header-13765785"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">12/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13765785"><td bgcolor="#ffffff">
            <p>Note so I do not forget: Wolfgang just mentioned that we are missing runtime libs that our tests don't require - such as Tika libs - our tests of course don't exercise all of them.</p>

<p>I'll need to make sure we pull all of those in.</p>
        </td></tr>
                <tr id="comment-header-13766220"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13766220"><td bgcolor="#ffffff">
            <p>I'm working on making a new patch with some changes:</p>


<ul>
	<li>I updated to Hadoop 2.1.0 beta</li>
</ul>


<ul>
	<li>I updated the versions of some of the dependencies</li>
</ul>


<ul>
	<li>I added some run time dependencies that the tests don't require as well as their license files</li>
</ul>


<ul>
	<li>I started working around the issue where the Yarn cluster is hard coded to write to the CWD/target illegal location. This involved copying and modding some Hadoop test files until we can get Hadoop to make things more flexible. Unfortunately there is still an issue - the mkdirs used by hdfs requires write permissions all the way up the tree it seems, whether the directory you are making already exists or not - this keeps the yarn mini test cluster from being able to run with our test policy. It fails in init when it does this mkdir. Don't know of a good workaround at the moment.</li>
</ul>

        </td></tr>
                <tr id="comment-header-13766252"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13766252"><td bgcolor="#ffffff">
            <p>Latest patch attached.</p>
        </td></tr>
                <tr id="comment-header-13766448"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jkrupan" id="word_commented_jkrupan" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jkrupan">Jack Krupansky</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13766448"><td bgcolor="#ffffff">
            <p>Fix version still says 4.5.</p>
        </td></tr>
                <tr id="comment-header-13766494"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13766494"><td bgcolor="#ffffff">
            <p>I've worked out the javadoc warnings - that has led to some new issue(s) with jtidy. It's failing on SolrReducer.html.</p>
        </td></tr>
                <tr id="comment-header-13766512"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13766512"><td bgcolor="#ffffff">
            <p>Got it - the jtidy output was very generic (failed, returned 1), but I worked out that the problem was some '&lt;' and '&gt;' in the javadoc of SolrReducer and another class or two. After addressing that and adding a couple package.html files,  the precommit ant task now passes.</p>

<p>I have a variety of items still on the TODO list, but I think the critical path to an initial commit is:</p>

<ul>
	<li>Move the Solr Morphline commands in.</li>
</ul>


<ul>
	<li>Get the tests to run without a hacked test.policy file - see my comment above about FileSystem#mkDirs.</li>
</ul>


<ul>
	<li>Look at the final jar we produce and how it works with the dependencies (eg it's currently going to the extraction contrib for tika, etc).</li>
</ul>


<p>The other outstanding issues are not blocking an initial commit I don't think.</p>

<p>Also, FYI, since I did not mention, the previous patch will run the mini cluster tests based on the tests.disableHdfs sys prop now, so that is checked off.</p>
        </td></tr>
                <tr id="comment-header-13767529"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">14/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13767529"><td bgcolor="#ffffff">
            <p>I've moved in the Solr Morphlines code from cdk-morphlines-solr-core and cdk-morphlines-solr-cell. I've made them compliant with the test framework and got the tests passing. There are still some ant precommit and license issues to handle, but otherwise this should be mostly done. I'm still unclear on what will be required for packaging, but I am tackling packaging last.</p>

<p>I've also updated the Tika parser dependencies to include a couple Solr did not have.</p>

<p>Once I wrap up the loose ends on this I'll attach my latest patch, and then, only two issues on the critical path:</p>

<ul>
	<li>Get the tests to run without a hacked test.policy file.</li>
	<li>Dist packaging.</li>
</ul>

        </td></tr>
                <tr id="comment-header-13767583"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">14/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13767583"><td bgcolor="#ffffff">
            <p>Latest patch with Solr Morphlines and the other items I mentioned above.</p>

<p>New issues though.</p>

<p>Something is still writing to {CWD}/target that I need to track down.</p>

<p>Precommit is not yet passing with Solr morphlines code - need to resolve use of forbidden apis:<br/>
<span class="error">&#91;forbidden-apis&#93;</span> Forbidden class/interface use: com.sun.org.apache.xml.internal.serialize.OutputFormat <span class="error">&#91;non-public internal runtime class&#93;</span><br/>
<span class="error">&#91;forbidden-apis&#93;</span>   in org.apache.solr.hadoop.morphline.solrcell.SolrCellBuilder$SolrCell (SolrCellBuilder.java:242)<br/>
<span class="error">&#91;forbidden-apis&#93;</span> Forbidden class/interface use: com.sun.org.apache.xml.internal.serialize.XMLSerializer <span class="error">&#91;non-public internal runtime class&#93;</span><br/>
<span class="error">&#91;forbidden-apis&#93;</span>   in org.apache.solr.hadoop.morphline.solrcell.SolrCellBuilder$SolrCell (SolrCellBuilder.java:242)</p>

<p>Also, I'm not sure where exactly the Solr morphlines should end up - as their own module or where I put them, but this is where they are for now.</p>
        </td></tr>
                <tr id="comment-header-13768629"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">16/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13768629"><td bgcolor="#ffffff">
            <p>cdk-morphlines-solr-core and cdk-morphlines-solr-cell should remain separate and be available through separate maven modules so that clients such as Flume Solr Sink and Hbase Indexer can continue to choose to depend (or not depend) on them. For example, not everyone wants tika and it's dependency chain.</p>
        </td></tr>
                <tr id="comment-header-13768662"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">16/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13768662"><td bgcolor="#ffffff">
            <p>Seems like the patch still misses tika-xmp.</p>
        </td></tr>
                <tr id="comment-header-13768772"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">16/Sep/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13768772"><td bgcolor="#ffffff">
            <p>This is likely the last patch I'll put up for a bit - I'm on vacation from Wed-Mon.</p>

<p>Patch Notes:</p>

<p>ant precommit passes again. I've fixed the forbidden api calls and a couple minor javadoc issues in the new morphlines code. Also fixed a more problematic javadocs issue due to broken links from the morphlines code to extraction code due to extending extraction classes.</p>

<p>I've added tika-xmp to the extraction dependencies.</p>

<p>I don't like that tests can pass when some necessary run-time jars are missing - we will likely need to look into adding simple tests that cause each necessary jar to be used - or even just have hack tests that try and create a class in the offending jars or something. I'll save that for a follow up issue though - the solr cell morphlines tests actually upped the number of dependencies tests hit quite a bit at least.</p>

<p>There is also a test speed issue that is not on the critical path - on my fast machine that does 8 tests in parallel, this adds about 4-5 minutes to the tests. It would be good to try and minimize some of the longer tests for std runs, and keep them as is for @nightly runs. That can wait post commit though.</p>

<p>That leaves the following 2 critical path items to deal with:</p>

<ul>
	<li>Get the tests to run without a hacked test.policy file.</li>
	<li>Dist packaging. This includes things like creation of the final MapReduceIndexerTool jar file and dealing with it's dependencies, as well as the location of the morphlines code and how it is distributed.</li>
</ul>


<p>Other than that we are looking pretty good - all tests passing and precommit passing.</p>

        </td></tr>
                <tr id="comment-header-13790411"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">09/Oct/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13790411"><td bgcolor="#ffffff">
            <p>I have a new patch I'm cleaning up that tackles some of the packaging:</p>


<ul>
	<li>Split out solr-morphlines-core and solr-morphlines-cell into their own modules.</li>
</ul>


<ul>
	<li>Updated to trunk and the new modules are now using the new dependency version tracking system.</li>
</ul>


<ul>
	<li>Fixed an issue in the code around the TokenStream contract being violated - the latest code detected this and failed a test - end and close now called.</li>
</ul>


<ul>
	<li>Updated to use Morphlines from CDK 0.8.</li>
</ul>


<ul>
	<li>Setup the main class in the solr-mr jar manifest.</li>
</ul>


<ul>
	<li>I enabled an ignored test which exposed a few bugs because of the required solr.xml in Solr 5.0 - I addressed those bugs.</li>
</ul>


<ul>
	<li>Added a missing metrics health-check dependency that somehow popped up.</li>
</ul>


<ul>
	<li>I played around with naming the solr-mr artifact MapReduceIndexTool.jar, but the system really want's us to follow the rules of the artifacts and have something like solr-solr-mr-5.0.jar. Anything else has some random issues, such as with javadoc, and if your name does not start with solr-, it will be changed to start with lucene-. I'm not yet sure if it's worth the trouble to expand the system or use a different name, so for now it's still just using the default jar name based on the contrib module name (solr-mr).</li>
</ul>


<p>Besides the naming issue, there are a couple other things to button up:</p>

<ul>
	<li>How we are going to set up the classpath - script, in the manifest, leave it up to the user and doc, etc.</li>
</ul>


<ul>
	<li>All dependencies are currently in solr-morphlines-core - this was a simple way to split out the modules since solr-mr and solr-morphlines-cell depend on solr-morphlines-core.</li>
</ul>


<p>Finally, we will probably need some help from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe" class="user-hover" rel="steve_rowe">Steve Rowe</a> to get the Maven build setup correctly.</p>

<p>I spent a bunch of time trying to use asm to work around the hacked test policy issue. There are multiple problems I ran into. One is that another module uses asm 4.1, but Hadoop brings in asm 3.1 - if you are doing some asm coding, this can cause compile issues with your ide (at least eclipse). It also ends up being really hard to get an injection in the right place because of how the yarn code is structured. After spending a bunch of time trying to get this to work, I'm backing out and considering other options.</p>
        </td></tr>
                <tr id="comment-header-13793868"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">14/Oct/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13793868"><td bgcolor="#ffffff">
            <p>Here is the patch I referred to in the above comment.</p>

<p>Precommit still passing and tests passing with the tests policy hack.</p>
        </td></tr>
                <tr id="comment-header-13824426"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="gro" id="word_commented_gro" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gro">Rafał Kuć</a>
                                        <font size="-2">
            [
                <font color="#336699">16/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13824426"><td bgcolor="#ffffff">
            <p>Mark, is the version attached to this issue a newest patch or maybe you have something newer?</p>
        </td></tr>
                <tr id="comment-header-13825363"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">18/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13825363"><td bgcolor="#ffffff">
            <p>Hey Rafal - that is the latest at the moment - gotten side tracked with other things. Shortly, I'll upload a new patch that changes around the dependencies between modules a bit. Beyond that there is figuring out the strategy for the classpath, some manual testing, and finally working around that darn test policy issue.</p>

<p>However, things should be in a useable state regardless of those remaining issues.</p>
        </td></tr>
                <tr id="comment-header-13825365"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="gro" id="word_commented_gro" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gro">Rafał Kuć</a>
                                        <font size="-2">
            [
                <font color="#336699">18/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13825365"><td bgcolor="#ffffff">
            <p>Thanks Mark <img class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/smile.gif" height="16" width="16" align="absmiddle" alt="" border="0"/></p>
        </td></tr>
                <tr id="comment-header-13829678"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">22/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13829678"><td bgcolor="#ffffff">
            <p>New Patch.</p>

<ul>
	<li>Updated to trunk</li>
</ul>


<ul>
	<li>A pass at putting dependencies in the correct modules</li>
</ul>


<ul>
	<li>A script for running the MapReduceIndexTool - classpath in the manifest doesn't seem very nice.</li>
</ul>


<ul>
	<li>Updated to CDK 0.8.1</li>
</ul>


<p>I'm sure there are a variety of other things to polish, fix, decide and finalize, as well as code to sync up - but nothing that needs to be done before this is committed. I need to get this in asap as it's a large burden to maintain over time.</p>

<p>Except for the test policy issue. That is the only blocker I know of for committing remaining.</p>

<p>Also have to do a bit of manual testing.</p>

<p>You can run the tool by running Solr's 'ant package' and then expand one of the release zip/tgz files. Try something like:</p>

<p>cd solr/example/scripts/solr-mr<br/>
sh solr-mr.sh --help</p>
        </td></tr>
                <tr id="comment-header-13832006"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">25/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13832006"><td bgcolor="#ffffff">
            <p>I have a plan for the test policy issue.</p>

<ul>
	<li>disable the couple large integration tests that have a problem by default</li>
	<li>use a 'no.test.policy' sys prop of some kind to allow those tests to run in a local jenkins setup with no test policy running</li>
	<li>file a jira with yarn requesting that they take pity on us and make it so that yarn will run with our test policy (eg, if this dir already exists, don't mkdirs up it's parents to the root)</li>
	<li>once that makes it into a release, we can reenable these couple tests by default</li>
</ul>

        </td></tr>
                <tr id="comment-header-13832151"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">26/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13832151"><td bgcolor="#ffffff">
            <p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe" class="user-hover" rel="steve_rowe">Steve Rowe</a> sir - I'm going to need your assistance I think <img class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/smile.gif" height="16" width="16" align="absmiddle" alt="" border="0"/></p>
        </td></tr>
                <tr id="comment-header-13832153"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="steve_rowe" id="word_commented_steve_rowe" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe">Steve Rowe</a>
                                        <font size="-2">
            [
                <font color="#336699">26/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13832153"><td bgcolor="#ffffff">
            <blockquote><p>Steve Rowe sir - I'm going to need your assistance I think </p></blockquote>

<p>I'll take a look.</p>
        </td></tr>
                <tr id="comment-header-13832481"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="steve_rowe" id="word_commented_steve_rowe" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe">Steve Rowe</a>
                                        <font size="-2">
            [
                <font color="#336699">26/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13832481"><td bgcolor="#ffffff">
            <p>FYI, when I apply the latest patch against trunk using <tt>svn patch <a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>.patch</tt>, svn says:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>Skipped missing target: 'solr/example/scripts/cloud-scripts/zkcli.sh'
Skipped missing target: 'solr/example/scripts/cloud-scripts/zkcli.bat'
</pre>
</div></div>

<p>The patch assumes these two files already exist, but <tt>solr/example/scripts/</tt> doesn't exist on trunk.</p>

<p>When I run the following before applying the patch, svn no longer complains about those scripts:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>svn mkdir solr/example/scripts
svn mv solr/example/cloud-scripts solr/example/scripts/
</pre>
</div></div>
        </td></tr>
                <tr id="comment-header-13832711"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">26/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13832711"><td bgcolor="#ffffff">
            <p>Sorry about that - eclipse gets confused sometimes when you do some local refactoring.</p>

<p>I'll commit to 5x and it will be easier to work on this.</p>
        </td></tr>
                <tr id="comment-header-13832721"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="steve_rowe" id="word_commented_steve_rowe" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe">Steve Rowe</a>
                                        <font size="-2">
            [
                <font color="#336699">26/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13832721"><td bgcolor="#ffffff">
            <p>bq, I'll commit to 5x and it will be easier to work on this.</p>

<p>I'm working on the Maven build, and am almost there - do you want to wait for a revised patch?  I also made some minor modifications to the Ant build: removed solr-mr dependency from solr-morphlines-cell; resolving solr-morphlines-core test deps to test-lib/ instead of lib/. </p>
        </td></tr>
                <tr id="comment-header-13832730"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">26/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13832730"><td bgcolor="#ffffff">
            <p>I was a little scared of committing from a patch and not the svn checkout I've been working from. It's such a huge patch <img class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/smile.gif" height="16" width="16" align="absmiddle" alt="" border="0"/></p>

<p>However, whatever is easiest for you.</p>
        </td></tr>
                <tr id="comment-header-13832732"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">26/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13832732"><td bgcolor="#ffffff">
            <blockquote><p>removed solr-mr dependency from solr-morphlines-cell; resolving solr-morphlines-core test deps to test-lib/ instead of lib/.</p></blockquote>

<p>Nice, thanks.</p>
        </td></tr>
                <tr id="comment-header-13832734"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="steve_rowe" id="word_commented_steve_rowe" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe">Steve Rowe</a>
                                        <font size="-2">
            [
                <font color="#336699">26/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13832734"><td bgcolor="#ffffff">
            <blockquote><p>It's such a huge patch</p></blockquote>

<p>Yeah, it is... </p>

<p>I guess you should commit, then I'll make a patch of the diff between my modified patched dir and what you commit.  That should be the simplest/least scary.</p>
        </td></tr>
                <tr id="comment-header-13832738"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="steve_rowe" id="word_commented_steve_rowe" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe">Steve Rowe</a>
                                        <font size="-2">
            [
                <font color="#336699">26/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13832738"><td bgcolor="#ffffff">
            <p>Mark, BTW, some tests are failing for me in solr-morphlines-cell and in solr-morphlines-core, and test(s?) are hanging in solr-mr (OS X, Oracle JDK 1.7.0_25), both with and without my modifications.  Hopefully it's just a local thing.</p>
        </td></tr>
                <tr id="comment-header-13833269"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="steve_rowe" id="word_commented_steve_rowe" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe">Steve Rowe</a>
                                        <font size="-2">
            [
                <font color="#336699">27/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13833269"><td bgcolor="#ffffff">
            <p>Patch that extends the Maven and IntelliJ builds to include the three new modules.  Minor Ant build modifications included as well.</p>

<p>This patch was created with <tt>dev-tools/scripts/diffSources.py</tt>, comparing two trunk directories patched with Mark's latest patch, the second of which has my modifications as well.  So it has to be applied after Mark's latest patch.</p>
        </td></tr>
                <tr id="comment-header-13833422"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">27/Nov/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13833422"><td bgcolor="#ffffff">
            <p>Thanks Steve - took me a bit, but I'm about ready to commit to 5x.</p>
        </td></tr>
                <tr id="comment-header-13836768"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13836768"><td bgcolor="#ffffff">
            <p>Commit 1547139 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1547139" class="external-link" rel="nofollow">https://svn.apache.org/r1547139</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Add a Solr contrib that allows for building Solr indexes via Hadoop's MapReduce.</p>
        </td></tr>
                <tr id="comment-header-13836909"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13836909"><td bgcolor="#ffffff">
            <p>Commit 1547187 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1547187" class="external-link" rel="nofollow">https://svn.apache.org/r1547187</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Ivy likes to act funny if you don't declare compile and test resources in the same dependency.</p>
        </td></tr>
                <tr id="comment-header-13836934"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13836934"><td bgcolor="#ffffff">
            <p>I've setup a local jenkins job to run the two tests that have a problem with the test policy/manager. Next I'll file a JIRA issue for Yarn.</p>
        </td></tr>
                <tr id="comment-header-13836945"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13836945"><td bgcolor="#ffffff">
            <p>One issue that I had to work around will be solved with <a href="https://issues.apache.org/jira/browse/YARN-1442" class="external-link" rel="nofollow">https://issues.apache.org/jira/browse/YARN-1442</a></p>
        </td></tr>
                <tr id="comment-header-13836988"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="thetaphi" id="word_commented_thetaphi" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi">Uwe Schindler</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13836988"><td bgcolor="#ffffff">
            <p>Hi,<br/>
it seems to resolve correctly now. There is one inconsistency: the folder names. The new contribs have all "solr-" in the folder name, which is inconsistent to the others. I would prefer to rename the folder names with <tt>svn mv</tt> and maybe fix some paths in dependencies and maven. The build.xml files use the correct name already, so JAR files are named correctly.<br/>
Uwe</p>
        </td></tr>
                <tr id="comment-header-13837001"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837001"><td bgcolor="#ffffff">
            <p>Removing solr from the module names sounds good to me.</p>
        </td></tr>
                <tr id="comment-header-13837032"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837032"><td bgcolor="#ffffff">
            <p>Commit 1547232 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi" class="user-hover" rel="thetaphi">Uwe Schindler</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1547232" class="external-link" rel="nofollow">https://svn.apache.org/r1547232</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Fix compilation for Java 8 (the Java 8 compiler is more picky, but it's not a Java 8 regression: the code was just wrong)</p>
        </td></tr>
                <tr id="comment-header-13837036"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="thetaphi" id="word_commented_thetaphi" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi">Uwe Schindler</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837036"><td bgcolor="#ffffff">
            <p>I found out that some tests don't work on Windows, for the same reason why the MiniDFS tests don't work in Solr-Core: Some crazy command line tools are missing. I would mark all those tests with the same assume like HdfsDirectory tests?</p>

<p>Should I start doing this?</p>
        </td></tr>
                <tr id="comment-header-13837049"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837049"><td bgcolor="#ffffff">
            <p>Hmm...yeah, you might as well. I'll investigate on my VM.</p>
        </td></tr>
                <tr id="comment-header-13837068"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837068"><td bgcolor="#ffffff">
            <p>There is also a known issue in that Morphlines don't work on Windows because the Guava Classpath utility doesn't work with windows path conventions. For example, see <a href="http://mail-archives.apache.org/mod_mbox/flume-dev/201310.mbox/%3C5ACFFCD9-4AD7-4E6E-8365-CEADFAC78B1A@cloudera.com%3E" class="external-link" rel="nofollow">http://mail-archives.apache.org/mod_mbox/flume-dev/201310.mbox/%3C5ACFFCD9-4AD7-4E6E-8365-CEADFAC78B1A@cloudera.com%3E</a></p>
        </td></tr>
                <tr id="comment-header-13837070"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837070"><td bgcolor="#ffffff">
            <p>Commit 1547239 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi" class="user-hover" rel="thetaphi">Uwe Schindler</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1547239" class="external-link" rel="nofollow">https://svn.apache.org/r1547239</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Fix windows problem with escaping of folder name (see crazy <a href="https://github.com/typesafehub/config/blob/master/HOCON.md" class="external-link" rel="nofollow">https://github.com/typesafehub/config/blob/master/HOCON.md</a> for correct format: string must be quoted and escaped like javascript)</p>
        </td></tr>
                <tr id="comment-header-13837090"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">02/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837090"><td bgcolor="#ffffff">
            <p>Commit 1547242 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi" class="user-hover" rel="thetaphi">Uwe Schindler</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1547242" class="external-link" rel="nofollow">https://svn.apache.org/r1547242</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Ignore windows tests that cannot work because they use UNIX semantics. Also remove a never-executed test which tests nothing</p>
        </td></tr>
                <tr id="comment-header-13837110"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="thetaphi" id="word_commented_thetaphi" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi">Uwe Schindler</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837110"><td bgcolor="#ffffff">
            <p>OK, I fixed the test suite to pass on Windows.</p>
        </td></tr>
                <tr id="comment-header-13837775"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837775"><td bgcolor="#ffffff">
            <p>For posterity, there is a thread on the dev list where we are working through an issue with Saxon on java 8 and ibm's j9. Wolfgang filed <a href="https://saxonica.plan.io/issues/1944" class="external-link" rel="nofollow">https://saxonica.plan.io/issues/1944</a> upstream. (Saxon is pulled in via cdk-morphlines-saxon).</p>
        </td></tr>
                <tr id="comment-header-13837808"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837808"><td bgcolor="#ffffff">
            <p>Commit 1547442 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1547442" class="external-link" rel="nofollow">https://svn.apache.org/r1547442</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Ignore these tests on java 8 and j9 for now.</p>
        </td></tr>
                <tr id="comment-header-13837830"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837830"><td bgcolor="#ffffff">
            <p>Removing Solr from the module names would give:</p>

<p><b>morphlines-cell</b> Perhaps should be morphlines-extraction? We have always made cell / extraction confusing. The module folder is extraction though, so I see that as the name. We really should standardize on one name.</p>

<p><b>morphlines-core</b> Removing Solr is a bit confusing - morphlines-core is a module in the morphlines project - this is a morphlines module with stuff for interacting with Solr - perhaps we just call it morphlines?</p>

<p><b>mr</b> Seems we should rename this. Steve suggested map-reduce-indexer in IRC, which seems good to me.</p>
        </td></tr>
                <tr id="comment-header-13837953"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837953"><td bgcolor="#ffffff">
            <p>Commit 1547498 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe" class="user-hover" rel="steve_rowe">Steve Rowe</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1547498" class="external-link" rel="nofollow">https://svn.apache.org/r1547498</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: remove unnecessary (POM-only) dependency org.apache.hadoop:hadoop-yarn-server</p>
        </td></tr>
                <tr id="comment-header-13837976"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837976"><td bgcolor="#ffffff">
            <blockquote><p>module/dir names</p></blockquote>

<p>I propose morphlines-solr-core and morphlines-solr-cell as names. This avoids confusion by fitting nicely with the existing naming pattern, which is cdk-morphlines-solr-core and cdk-morphlines-solr-cell. (<a href="https://github.com/cloudera/cdk/tree/master/cdk-morphlines" class="external-link" rel="nofollow">https://github.com/cloudera/cdk/tree/master/cdk-morphlines</a>). Thoughts?</p>
        </td></tr>
                <tr id="comment-header-13837979"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13837979"><td bgcolor="#ffffff">
            <p>+1 to "map-reduce-indexer" module name/dir.</p>
        </td></tr>
                <tr id="comment-header-13838038"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="steve_rowe" id="word_commented_steve_rowe" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe">Steve Rowe</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13838038"><td bgcolor="#ffffff">
            <blockquote><p>I propose morphlines-solr-core and morphlines-solr-cell as names. This avoids confusion by fitting nicely with the existing naming pattern, which is cdk-morphlines-solr-core and cdk-morphlines-solr-cell. (<a href="https://github.com/cloudera/cdk/tree/master/cdk-morphlines" class="external-link" rel="nofollow">https://github.com/cloudera/cdk/tree/master/cdk-morphlines</a>). Thoughts?</p></blockquote>

<p>The problem with these two names is that the artifact names will have "solr-" prepended, and then "solr" will occur twice in their names: <tt>solr-morphlines-solr-core-4.7.0.jar</tt>, <tt>solr-morphlines-solr-cell-4.7.0.jar</tt>.  Yuck.</p>
        </td></tr>
                <tr id="comment-header-13838039"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13838039"><td bgcolor="#ffffff">
            <p>That sounds fine to me.</p>
        </td></tr>
                <tr id="comment-header-13838040"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13838040"><td bgcolor="#ffffff">
            <blockquote><p>Yuck.</p></blockquote>

<p>Whoops - cross posted. Yeah, didn't realize that - not ideal.</p>
        </td></tr>
                <tr id="comment-header-13838054"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13838054"><td bgcolor="#ffffff">
            <blockquote><p>The problem with these two names is that the artifact names will have "solr-" prepended, and then "solr" will occur twice in their names: solr-morphlines-solr-core-4.7.0.jar, solr-morphlines-solr-cell-4.7.0.jar. Yuck.</p></blockquote>

<p>Ah, argh. In this light, what Mark suggested seems good to me as well.</p>
        </td></tr>
                <tr id="comment-header-13838060"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="steve_rowe" id="word_commented_steve_rowe" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe">Steve Rowe</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13838060"><td bgcolor="#ffffff">
            <blockquote><p>In this light, what Mark suggested seems good to me as well.</p></blockquote>

<p>+1 to:</p>

<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>contrib name</th>
<th class='confluenceTh'>artifact name</th>
</tr>
<tr>
<td class='confluenceTd'>morphlines-core</td>
<td class='confluenceTd'>solr-morphlines-core</td>
</tr>
<tr>
<td class='confluenceTd'>morphlines-cell</td>
<td class='confluenceTd'>solr-morphlines-cell</td>
</tr>
<tr>
<td class='confluenceTd'>map-reduce-indexer</td>
<td class='confluenceTd'>solr-map-reduce-indexer</td>
</tr>
</tbody></table>

        </td></tr>
                <tr id="comment-header-13838064"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13838064"><td bgcolor="#ffffff">
            <p>+1 on  Steve's suggestion as well. Thanks for helping out!</p>
        </td></tr>
                <tr id="comment-header-13838305"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">03/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13838305"><td bgcolor="#ffffff">
            <p>Upon a bit more reflection might be better to call the contrib "map-reduce" and the artifact "solr-map-reduce". This keeps the door open to potentially later add things like a Hadoop SolrInputFormat, i.e. read from solr via MR, rather than just write to solr via MR.</p>
        </td></tr>
                <tr id="comment-header-13838968"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">04/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13838968"><td bgcolor="#ffffff">
            <p>Commit 1547819 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1547819" class="external-link" rel="nofollow">https://svn.apache.org/r1547819</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Straighten out module names so that they match current convention</p>
        </td></tr>
                <tr id="comment-header-13839173"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">04/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13839173"><td bgcolor="#ffffff">
            <p>Commit 1547871 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1547871" class="external-link" rel="nofollow">https://svn.apache.org/r1547871</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Merge in latest solr-map-reduce updates.</p>
        </td></tr>
                <tr id="comment-header-13839228"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">04/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13839228"><td bgcolor="#ffffff">
            <p>Commit 1547879 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1547879" class="external-link" rel="nofollow">https://svn.apache.org/r1547879</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Merge in latest morphlines module updates.</p>
        </td></tr>
                <tr id="comment-header-13839237"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">04/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13839237"><td bgcolor="#ffffff">
            <p>MorphlineGoLiveMiniMRTest, which is ignored while the test policy issue gets straightened out, is now too slow for the standard test run. Before re-enabling it, we will have to tone it down for non nightly runs.</p>
        </td></tr>
                <tr id="comment-header-13839308"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">04/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13839308"><td bgcolor="#ffffff">
            <p>There are also some fixes downstream in cdk-morphlines-core and cdk-morphlines-solr-cell that would be good to push upstream.</p>
        </td></tr>
                <tr id="comment-header-13839311"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">04/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13839311"><td bgcolor="#ffffff">
            <p>Minor nit: could remove jobConf.setBoolean(ExtractingParams.IGNORE_TIKA_EXCEPTION, false) in MorphlineBasicMiniMRTest + MorphlineGoLiveMiniMRTest because such a flag is nomore needed, and it removes an unnecessary dependency on tika.</p>

        </td></tr>
                <tr id="comment-header-13839459"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">04/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13839459"><td bgcolor="#ffffff">
            <blockquote><p>it removes an unnecessary dependency on tika.</p></blockquote>

<p>Whoops - that is why I had changed to just using the string param and I accidentally just reverted that in the merge. I'll remove the params entirely.</p>
        </td></tr>
                <tr id="comment-header-13839478"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">04/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13839478"><td bgcolor="#ffffff">
            <p>Commit 1547962 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1547962" class="external-link" rel="nofollow">https://svn.apache.org/r1547962</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Clean up.</p>
        </td></tr>
                <tr id="comment-header-13839556"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">05/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13839556"><td bgcolor="#ffffff">
            <p>FWIW, a current printout of --help showing the CLI options is here: <a href="https://github.com/cloudera/search/tree/master_1.1.0/search-mr" class="external-link" rel="nofollow">https://github.com/cloudera/search/tree/master_1.1.0/search-mr</a></p>
        </td></tr>
                <tr id="comment-header-13840633"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">05/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13840633"><td bgcolor="#ffffff">
            <p>Commit 1548319 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe" class="user-hover" rel="steve_rowe">Steve Rowe</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1548319" class="external-link" rel="nofollow">https://svn.apache.org/r1548319</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: ignore '<b>.iml' in new Solr contribs' directories; put new Solr contribs' lib/ and test-lib/ directories under Subversion control; ignore '</b>.jar' in these directories</p>
        </td></tr>
                <tr id="comment-header-13841058"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">06/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13841058"><td bgcolor="#ffffff">
            <p>Getting started at the moment might be a bit daunting - to help people get started, to help with testing, and to help with figuring out what we need to provide to improve usability, I've started the following GitHub project: <a href="https://github.com/markrmiller/solr-map-reduce-example" class="external-link" rel="nofollow">https://github.com/markrmiller/solr-map-reduce-example</a></p>

<p>It's a script that downloads Hadoop and a nightly build of Solr and then builds an index via map-reduce and deploys that index to Solr.</p>

<p>For now, it's just for looking - it won't actually work until I make a couple commits so that the standard example config files will correctly work with the map-reduce module.</p>

<p>This should lower the barrier to entry for anyone that wants to play with things and serve as a nice guide for those looking to try this out on a real cluster.</p>

<p>I'll make the commit(s) I referenced above sometime today later when I wake up.</p>
        </td></tr>
                <tr id="comment-header-13841429"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">06/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13841429"><td bgcolor="#ffffff">
            <p>Commit 1548600 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1548600" class="external-link" rel="nofollow">https://svn.apache.org/r1548600</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Fix a couple of bugs around setting up the embedded Solr instance.</p>
        </td></tr>
                <tr id="comment-header-13841434"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">06/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13841434"><td bgcolor="#ffffff">
            <p>My plan is to merge this back to 4X before long - I do think we should mark it as an experimental module though and avoid promising strong back compat for a couple of releases. 4X releases frequently and we want to gather some feedback before locking in too much.</p>
        </td></tr>
                <tr id="comment-header-13841453"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">06/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13841453"><td bgcolor="#ffffff">
            <p>Commit 1548605 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1548605" class="external-link" rel="nofollow">https://svn.apache.org/r1548605</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Update to Morphlines 0.9.0</p>
        </td></tr>
                <tr id="comment-header-13841915"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">06/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13841915"><td bgcolor="#ffffff">
            <p>If you want to try this out, this example repo script should now be working for everyone: <a href="https://github.com/markrmiller/solr-map-reduce-example" class="external-link" rel="nofollow">https://github.com/markrmiller/solr-map-reduce-example</a></p>

<p>It works with Linux and I just updated it to work with OSX (at least my copies).</p>
        </td></tr>
                <tr id="comment-header-13842034"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">07/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13842034"><td bgcolor="#ffffff">
            <p>There are also some important fixes downstream in 0.9.0 of cdk-morphlines-solr-core and cdk-morphlines-solr-cell that would be good to merge upstream (solr locator race, solr cell bug, etc). Also there are new morphline modules jars to add with 0.9.0 and jars to update (plus upstream is also missing some morphline modules from 0.8 as well)</p>
        </td></tr>
                <tr id="comment-header-13842093"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">07/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13842093"><td bgcolor="#ffffff">
            <p>Commit 1548795 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1548795" class="external-link" rel="nofollow">https://svn.apache.org/r1548795</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Update jar checksums for Morphlines 0.9.0</p>
        </td></tr>
                <tr id="comment-header-13842555"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="steve_rowe" id="word_commented_steve_rowe" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe">Steve Rowe</a>
                                        <font size="-2">
            [
                <font color="#336699">08/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13842555"><td bgcolor="#ffffff">
            <p>The Maven Jenkins build on trunk has been failing for a while because <tt>com.sun.jersey:jersey-bundle:1.8</tt>, a morphlines-core dependency, causes <tt>ant validate-maven-dependencies</tt> to fail - here's a log excerpt from the most recent failure <a href="https://builds.apache.org/job/Lucene-Solr-Maven-trunk/1046/console" class="external-link" rel="nofollow">https://builds.apache.org/job/Lucene-Solr-Maven-trunk/1046/console</a>:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>     [echo] Building solr-map-reduce...

-validate-maven-dependencies.init:

-validate-maven-dependencies:
[artifact:dependencies] [INFO] snapshot org.apache.solr:solr-cell:5.0-SNAPSHOT: checking for updates from maven-restlet
[artifact:dependencies] [INFO] snapshot org.apache.solr:solr-cell:5.0-SNAPSHOT: checking for updates from releases.cloudera.com
[artifact:dependencies] [INFO] snapshot org.apache.solr:solr-morphlines-cell:5.0-SNAPSHOT: checking for updates from maven-restlet
[artifact:dependencies] [INFO] snapshot org.apache.solr:solr-morphlines-cell:5.0-SNAPSHOT: checking for updates from releases.cloudera.com
[artifact:dependencies] [INFO] snapshot org.apache.solr:solr-morphlines-core:5.0-SNAPSHOT: checking for updates from maven-restlet
[artifact:dependencies] [INFO] snapshot org.apache.solr:solr-morphlines-core:5.0-SNAPSHOT: checking for updates from releases.cloudera.com
[artifact:dependencies] An error has occurred while processing the Maven artifact tasks.
[artifact:dependencies]  Diagnosis:
[artifact:dependencies] 
[artifact:dependencies] Unable to resolve artifact: Unable to get dependency information: Unable to read the metadata file for artifact 'com.sun.jersey:jersey-bundle:jar': Cannot find parent: com.sun.jersey:jersey-project for project: null:jersey-bundle:jar:null for project null:jersey-bundle:jar:null
[artifact:dependencies]   com.sun.jersey:jersey-bundle:jar:1.8
[artifact:dependencies] 
[artifact:dependencies] from the specified remote repositories:
[artifact:dependencies]   central (http://repo1.maven.org/maven2),
[artifact:dependencies]   releases.cloudera.com (https://repository.cloudera.com/artifactory/libs-release),
[artifact:dependencies]   maven-restlet (http://maven.restlet.org),
[artifact:dependencies]   Nexus (http://repository.apache.org/snapshots)
[artifact:dependencies] 
[artifact:dependencies] Path to dependency: 
[artifact:dependencies] 	1) org.apache.solr:solr-map-reduce:jar:5.0-SNAPSHOT
[artifact:dependencies] 
[artifact:dependencies] 
[artifact:dependencies] Not a v4.0.0 POM. for project com.sun.jersey:jersey-project at /home/hudson/.m2/repository/com/sun/jersey/jersey-project/1.8/jersey-project-1.8.pom
</pre>
</div></div>

<p>I couldn't reproduce locally.</p>

<p>Turns out the parent POM in question, at <tt>/home/hudson/.m2/repository/com/sun/jersey/jersey-project/1.8/jersey-project-1.8.pom</tt>, has the wrong contents:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>&lt;html&gt;
&lt;head&gt;&lt;title&gt;301 Moved Permanently&lt;/title&gt;&lt;/head&gt;
&lt;body bgcolor="white"&gt;
&lt;center&gt;&lt;h1&gt;301 Moved Permanently&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;nginx/0.6.39&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
</div></div>

<p>I replaced this by manually downloading the correct POM and it's checksum file from Maven Central and putting them in the hudson user's local Maven repository.</p>

<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a>: While investigating this failure, I tried dropping the triggering Ivy dependency com.sun.jersey:jersey-bundle, and all enabled tests succeed.  Okay with you to drop this dependency?  The description from the POM says:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml">
<span class="code-tag">&lt;description&gt;</span>
A bundle containing code of all jar-based modules that provide JAX-RS and Jersey-related features. Such a bundle is *only intended* for developers that do not use Maven's dependency system. The bundle does not include code for contributes, tests and samples.
<span class="code-tag">&lt;/description&gt;</span>
</pre>
</div></div>

<p>Sounds like it's a sneaky replacement for transitive dependencies?  IMHO, if we need some of the classes this jar provides, we should declare direct dependencies on the appropriate artifacts.</p>
        </td></tr>
                <tr id="comment-header-13843343"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">09/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13843343"><td bgcolor="#ffffff">
            <blockquote><p>if we need some of the classes this jar provides, we should declare direct dependencies on the appropriate artifacts.</p></blockquote>

<p>Right - Wolfgang likely knows best when it comes to Morphlines.. At a minimum we should pull the necessary jars in explicitly I think. I've got to take a look at what they are.</p>
        </td></tr>
                <tr id="comment-header-13843443"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">09/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13843443"><td bgcolor="#ffffff">
            <p>I'm not aware of anything needing jersey except perhaps hadoop pulls that in.</p>

<p>The combined dependencies of all morphline modules is here: <a href="http://cloudera.github.io/cdk/docs/current/cdk-morphlines/cdk-morphlines-all/dependencies.html" class="external-link" rel="nofollow">http://cloudera.github.io/cdk/docs/current/cdk-morphlines/cdk-morphlines-all/dependencies.html</a></p>

<p>The dependencies of each individual morphline modules is here: <a href="http://cloudera.github.io/cdk/docs/current/dependencies.html" class="external-link" rel="nofollow">http://cloudera.github.io/cdk/docs/current/dependencies.html</a></p>

<p>The source and POMs are here, as usual: <a href="https://github.com/cloudera/cdk/tree/master/cdk-morphlines" class="external-link" rel="nofollow">https://github.com/cloudera/cdk/tree/master/cdk-morphlines</a></p>

<p>By the way, a somewhat separate issue is that it seems to me that the ivy dependences for solr-morphlines-core and solr-morphlines-cell and solr-map-reduce are a bit backwards upstream in that currently solr-morphlines-core pulls in a ton of dependencies that it doesn't need, and those deps should rather be pulled in by the solr-map-reduce (which is a essentially an out-of-the-box app that bundles user level deps). Correspondingly, would be good to organize ivy and mvn upstream in such a way that </p>

<ul>
	<li>solr-map-reduce should depend on solr-morphlines-cell plus cdk-morphlines-all minus cdk-morphlines-solr-cell (now upstream) minus cdk-morphlines-solr-core (now upstream) plus xyz</li>
	<li>solr-morphlines-cell should depend on solr-morphlines-core plus xyz</li>
	<li>solr-morphlines-core should depend on cdk-morphlines-core plus xyz</li>
</ul>


<p>More concretely, FWIW, to see how the deps look like in production releases downstream review the following POMs: </p>

<p><a href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-core/pom.xml" class="external-link" rel="nofollow">https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-core/pom.xml</a></p>

<p>and</p>

<p><a href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-cell/pom.xml" class="external-link" rel="nofollow">https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-cell/pom.xml</a></p>

<p>and</p>

<p><a href="https://github.com/cloudera/search/blob/master_1.1.0/search-mr/pom.xml" class="external-link" rel="nofollow">https://github.com/cloudera/search/blob/master_1.1.0/search-mr/pom.xml</a></p>
        </td></tr>
                <tr id="comment-header-13843496"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="steve_rowe" id="word_commented_steve_rowe" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe">Steve Rowe</a>
                                        <font size="-2">
            [
                <font color="#336699">09/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13843496"><td bgcolor="#ffffff">
            <p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek" class="user-hover" rel="whoschek">wolfgang hoschek</a>, I'm lost: what do you mean by "upstream"/"downstream"?  In my experience, "upstream" refers to a parent project, i.e. one from which the project in question is derived, and "downstream" is the child/derived project.  I don't know the history here, but you seem to be referring to the solr contribs when you say "upstream"?  If that's true, then my understanding of these terms is the opposite of how you're using them.  Maybe the question I should be asking is: what is/are the relationship(s) between/among cdk-morphlines-solr-* and solr-morphlines-*?</p>

<p>And (I assume) relatedly, how how does cdk-morphlines-all relate to cdk-morphlines-solr-core/-cell?</p>
        </td></tr>
                <tr id="comment-header-13843523"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">09/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13843523"><td bgcolor="#ffffff">
            <p>Apologies for the confusion. We are upstreaming cdk-morphlines-solr-cell into the solr contrib solr-morphlines-cell as well as cdk-morphlines-solr-core into the solr contrib solr-morphlines-core as well as search-mr into the solr contrib solr-map-reduce. Once the upstreaming is done these old modules will go away. Next, "downstream" will be made identical to "upstream" plus perhaps some critical fixes as necessary, and the upstream/downstream terms will apply in the way folks usually think about them, but we are not quite yet there today, but getting there...</p>

<p>cdk-morphlines-all is simply a convenience pom that includes all the other morphline poms so there's less to type for users who like a bit more auto magic.</p>
        </td></tr>
                <tr id="comment-header-13843524"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="steve_rowe" id="word_commented_steve_rowe" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe">Steve Rowe</a>
                                        <font size="-2">
            [
                <font color="#336699">09/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13843524"><td bgcolor="#ffffff">
            <blockquote><p>And (I assume) relatedly, how how does cdk-morphlines-all relate to cdk-morphlines-solr-core/-cell?</p></blockquote>

<p>I can answer this one myself from <a href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-all/pom.xml" class="external-link" rel="nofollow">https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-all/pom.xml</a>: it's an aggregation-only module that depends on all of the cdk-morphlines-* modules.</p>
        </td></tr>
                <tr id="comment-header-13843827"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">10/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13843827"><td bgcolor="#ffffff">
            <blockquote><p>I'm not aware of anything needing jersey except perhaps hadoop pulls that in.</p></blockquote>

<p>Yeah, tests use this for running hadoop.</p>
        </td></tr>
                <tr id="comment-header-13846975"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="garyschulte" id="word_commented_garyschulte" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garyschulte">Gary Schulte</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13846975"><td bgcolor="#ffffff">
            <p>FYI, a colleague and I just spent the better part of a week trying to get the latest 1301 patch against 4.6 working in our cdh 4.1.2 dev environment, and/or a local cdh 4.3 cluster.    </p>

<p>We discovered that while the indexing process itself worked and we could see the docs and index merges in the reducer output logs, we never actually ended up with anything in the data directories in hdfs for our shards.  </p>

<p>Presumably, hadoop 2.0 is silently fails to do a distributed write when solr is using hdfs for a core's data directory.  After reverting SolrRecordWriter to the prior behavior of generating a local index and copying it to hdfs on completion, we were able to get MR indexing to work.</p>
        </td></tr>
                <tr id="comment-header-13846986"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13846986"><td bgcolor="#ffffff">
            <p>Sorry - latest patch is no good due to a bug. It was writing the data to the local filesystem. A lot has been committed beyond the last patch. </p>
        </td></tr>
                <tr id="comment-header-13846989"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13846989"><td bgcolor="#ffffff">
            <p>You need at least the commit above that talks about fixing where we set system properties in the solr record writer. </p>
        </td></tr>
                <tr id="comment-header-13846998"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="garyschulte" id="word_commented_garyschulte" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garyschulte">Gary Schulte</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13846998"><td bgcolor="#ffffff">
            <p>I am getting the same behavior from solr/contrib/map-reduce in <a href="http://svn.apache.org/repos/asf/lucene/dev/trunk" class="external-link" rel="nofollow">http://svn.apache.org/repos/asf/lucene/dev/trunk</a> </p>

<p>I just verified I am able to reproduce this behavior on cdh 4.1.2 even after <a href="https://svn.apache.org/r1548600" class="external-link" rel="nofollow">https://svn.apache.org/r1548600</a></p>

        </td></tr>
                <tr id="comment-header-13847007"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13847007"><td bgcolor="#ffffff">
            <p>Strange - should work fine. If I run the github project above, it has the index in hdfs and they are merged to solr. It uses 5x from a couple days ago. </p>
        </td></tr>
                <tr id="comment-header-13847011"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13847011"><td bgcolor="#ffffff">
            <p>It's the "fix a couple bugs around setting up embeddedsolrserver" commit. Keep in mind your solrconfig will need to have the directoryFactory setup to be subbed by sys prop currently - as it is by default.. </p>
        </td></tr>
                <tr id="comment-header-13847016"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="garyschulte" id="word_commented_garyschulte" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garyschulte">Gary Schulte</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13847016"><td bgcolor="#ffffff">
            <p>The example works fine for us also.  The reality is that we are still on java 1.6 for the most part and therefore can't use Solr 5.x.  All of our testing is with java 1.6 and lucene_solr_4_6. </p>

<p>We've tried using solr-mr with the 1301 patch against 4.6, as well as 'transplanting' contrib/map-reduce from trunk into the 4.6 branch.  Both yield the same behavior.  Indexing works, but the indexes never 'arrive' in hdfs.   </p>

<p>Perhaps there is an issue with solr-core and hdfs that was addressed in trunk that we haven't picked up?  (due to our java 1.6 source restriction)</p>
        </td></tr>
                <tr id="comment-header-13847020"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13847020"><td bgcolor="#ffffff">
            <p>I'd bet the hdfs directory is not being set for some reason. I was seeing the same thing until that commit. Look around for an errant folder being created on the local fs that starts with hdfs. </p>
        </td></tr>
                <tr id="comment-header-13847024"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="garyschulte" id="word_commented_garyschulte" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garyschulte">Gary Schulte</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13847024"><td bgcolor="#ffffff">
            <p>The directoryFactory appears to have been the root of the issue.  We were adapting our local solrconfig for use in the embedded solr server and did not have :</p>

<p>  &lt;directoryFactory name="DirectoryFactory"<br/>
                    class="$</p>
{solr.directoryFactory:solr.NRTCachingDirectoryFactory}
<p>"/&gt;</p>

<p>in our setup.  In light of that, we can confirm it works on cdh 4.1.2.  Thx</p>
        </td></tr>
                <tr id="comment-header-13847025"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13847025"><td bgcolor="#ffffff">
            <p>Thanks for closing the loop on that. That part is fragile - will be improved. </p>
        </td></tr>
                <tr id="comment-header-13848029"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="garyschulte" id="word_commented_garyschulte" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garyschulte">Gary Schulte</a>
                                        <font size="-2">
            [
                <font color="#336699">13/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13848029"><td bgcolor="#ffffff">
            <p>Some additional feedback, it would be convenient if we could ignore the underscore ("_") hidden files in hdfs as well as the "." hidden files when reading input files from hdfs.  </p>

<p>When trying to index an AvroStorage directory created by Pig, we are having to send each part name individually because the job will fail if we pass the directory.  Passing the directory, we end up picking up "_logs/*", "_SUCCESS", etc - the corresponding avro morphlines map jobs fail.   </p>
        </td></tr>
                <tr id="comment-header-13848097"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">14/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13848097"><td bgcolor="#ffffff">
            <p>Might be best to write a program that generates the list of files and then explicitly provide that file list to the MR job, e.g. via the --input-list option. For example you could use the HDFS version of the Linux file system 'find' command for that (HdfsFindTool doc and code here: <a href="https://github.com/cloudera/search/tree/master_1.1.0/search-mr#hdfsfindtool" class="external-link" rel="nofollow">https://github.com/cloudera/search/tree/master_1.1.0/search-mr#hdfsfindtool</a>)</p>

        </td></tr>
                <tr id="comment-header-13848775"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">16/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13848775"><td bgcolor="#ffffff">
            <blockquote><p>it would be convenient if we could ignore the underscore ("_") hidden files in hdfs as well as the "." hidden files when reading input files from hdfs.</p></blockquote>

<p>+1</p>
        </td></tr>
                <tr id="comment-header-13853071"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">19/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13853071"><td bgcolor="#ffffff">
            <p>Commit 1552381 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1552381" class="external-link" rel="nofollow">https://svn.apache.org/r1552381</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Update to Kite 0.10 from CDK 0.9</p>
        </td></tr>
                <tr id="comment-header-13853163"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">19/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13853163"><td bgcolor="#ffffff">
            <p>Commit 1552398 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1552398" class="external-link" rel="nofollow">https://svn.apache.org/r1552398</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Merge Morphlines modules up to Kite 0.10 and CDK 0.9</p>
        </td></tr>
                <tr id="comment-header-13855859"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">23/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13855859"><td bgcolor="#ffffff">
            <p>Commit 1553184 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1553184" class="external-link" rel="nofollow">https://svn.apache.org/r1553184</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Ignore this test on Windows - there is a problem with Windows paths and Morphlines.</p>
        </td></tr>
                <tr id="comment-header-13856340"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">24/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13856340"><td bgcolor="#ffffff">
            <p>Commit 1553281 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe" class="user-hover" rel="steve_rowe">Steve Rowe</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1553281" class="external-link" rel="nofollow">https://svn.apache.org/r1553281</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: maven config: fix map-reduce test compilation problem by adding dependency on morphline-core's test jar</p>
        </td></tr>
                <tr id="comment-header-13856657"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="whoschek" id="word_commented_whoschek" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=whoschek">wolfgang hoschek</a>
                                        <font size="-2">
            [
                <font color="#336699">25/Dec/13</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13856657"><td bgcolor="#ffffff">
            <p>Also see <a href="https://issues.cloudera.org/browse/CDK-262" class="external-link" rel="nofollow">https://issues.cloudera.org/browse/CDK-262</a></p>
        </td></tr>
                <tr id="comment-header-13862719"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">06/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13862719"><td bgcolor="#ffffff">
            <p>Commit 1555647 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1555647" class="external-link" rel="nofollow">https://svn.apache.org/r1555647</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: make debugging these tests a whole lot easier by sending map reduce job logging to std out</p>
        </td></tr>
                <tr id="comment-header-13862737"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">06/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13862737"><td bgcolor="#ffffff">
            <p>Bah - I think the above commit only works on map reduce one as far as sending the logs to std out. Tried to write some code to do it for map reduce 2, but I have not been able to figure out how to programmaticly get the secret key to hash the request url for the http logs API.</p>
        </td></tr>
                <tr id="comment-header-13866723"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">09/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13866723"><td bgcolor="#ffffff">
            <p>Commit 1556846 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe" class="user-hover" rel="steve_rowe">Steve Rowe</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1556846" class="external-link" rel="nofollow">https://svn.apache.org/r1556846</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: IntelliJ config: morphlines-cell Solr contrib needs lucene-core test-scope dependency</p>
        </td></tr>
                <tr id="comment-header-13872435"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872435"><td bgcolor="#ffffff">
            <p>Commit 1558520 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558520" class="external-link" rel="nofollow">https://svn.apache.org/r1558520</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Add a Solr contrib that allows for building Solr indexes via Hadoop's MapReduce.</p>
        </td></tr>
                <tr id="comment-header-13872441"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872441"><td bgcolor="#ffffff">
            <p>Commit 1558522 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558522" class="external-link" rel="nofollow">https://svn.apache.org/r1558522</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Ivy likes to act funny if you don't declare compile and test resources in the same dependency.</p>
        </td></tr>
                <tr id="comment-header-13872443"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872443"><td bgcolor="#ffffff">
            <p>Commit 1558523 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558523" class="external-link" rel="nofollow">https://svn.apache.org/r1558523</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Fix compilation for Java 8 (the Java 8 compiler is more picky, but it's not a Java 8 regression: the code was just wrong)</p>
        </td></tr>
                <tr id="comment-header-13872448"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872448"><td bgcolor="#ffffff">
            <p>Commit 1558524 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558524" class="external-link" rel="nofollow">https://svn.apache.org/r1558524</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Fix windows problem with escaping of folder name (see crazy <a href="https://github.com/typesafehub/config/blob/master/HOCON.md" class="external-link" rel="nofollow">https://github.com/typesafehub/config/blob/master/HOCON.md</a> for correct format: string must be quoted and escaped like javascript)</p>
        </td></tr>
                <tr id="comment-header-13872450"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872450"><td bgcolor="#ffffff">
            <p>Commit 1558525 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558525" class="external-link" rel="nofollow">https://svn.apache.org/r1558525</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Ignore windows tests that cannot work because they use UNIX semantics. Also remove a never-executed test which tests nothing</p>
        </td></tr>
                <tr id="comment-header-13872455"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872455"><td bgcolor="#ffffff">
            <p>Commit 1558529 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558529" class="external-link" rel="nofollow">https://svn.apache.org/r1558529</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Ignore these tests on java 8 and j9 for now.</p>
        </td></tr>
                <tr id="comment-header-13872460"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872460"><td bgcolor="#ffffff">
            <p>Commit 1558533 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558533" class="external-link" rel="nofollow">https://svn.apache.org/r1558533</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: remove unnecessary (POM-only) dependency org.apache.hadoop:hadoop-yarn-server</p>
        </td></tr>
                <tr id="comment-header-13872481"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872481"><td bgcolor="#ffffff">
            <p>Commit 1558540 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558540" class="external-link" rel="nofollow">https://svn.apache.org/r1558540</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Straighten out module names so that they match current convention</p>
        </td></tr>
                <tr id="comment-header-13872485"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872485"><td bgcolor="#ffffff">
            <p>Commit 1558541 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558541" class="external-link" rel="nofollow">https://svn.apache.org/r1558541</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Merge in latest solr-map-reduce updates.</p>
        </td></tr>
                <tr id="comment-header-13872489"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872489"><td bgcolor="#ffffff">
            <p>Commit 1558544 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558544" class="external-link" rel="nofollow">https://svn.apache.org/r1558544</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Merge in latest morphlines module updates.</p>
        </td></tr>
                <tr id="comment-header-13872492"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872492"><td bgcolor="#ffffff">
            <p>Commit 1558545 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558545" class="external-link" rel="nofollow">https://svn.apache.org/r1558545</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Clean up.</p>
        </td></tr>
                <tr id="comment-header-13872497"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872497"><td bgcolor="#ffffff">
            <p>Commit 1558547 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558547" class="external-link" rel="nofollow">https://svn.apache.org/r1558547</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: ignore '.iml' in new Solr contribs' directories; put new Solr contribs' lib/ and test-lib/ directories under Subversion control; ignore '.jar' in these directories</p>
        </td></tr>
                <tr id="comment-header-13872500"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872500"><td bgcolor="#ffffff">
            <p>Commit 1558548 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558548" class="external-link" rel="nofollow">https://svn.apache.org/r1558548</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Fix a couple of bugs around setting up the embedded Solr instance.</p>
        </td></tr>
                <tr id="comment-header-13872505"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872505"><td bgcolor="#ffffff">
            <p>Commit 1558551 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558551" class="external-link" rel="nofollow">https://svn.apache.org/r1558551</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Update to Morphlines 0.9.0</p>
        </td></tr>
                <tr id="comment-header-13872512"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872512"><td bgcolor="#ffffff">
            <p>Commit 1558553 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558553" class="external-link" rel="nofollow">https://svn.apache.org/r1558553</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Update jar checksums for Morphlines 0.9.0</p>
        </td></tr>
                <tr id="comment-header-13872636"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872636"><td bgcolor="#ffffff">
            <p>Commit 1558572 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558572" class="external-link" rel="nofollow">https://svn.apache.org/r1558572</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Update to Kite 0.10 from CDK 0.9</p>
        </td></tr>
                <tr id="comment-header-13872652"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872652"><td bgcolor="#ffffff">
            <p>Commit 1558580 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558580" class="external-link" rel="nofollow">https://svn.apache.org/r1558580</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Merge Morphlines modules up to Kite 0.10 and CDK 0.9</p>
        </td></tr>
                <tr id="comment-header-13872654"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872654"><td bgcolor="#ffffff">
            <p>Commit 1558582 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558582" class="external-link" rel="nofollow">https://svn.apache.org/r1558582</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Ignore this test on Windows - there is a problem with Windows paths and Morphlines.</p>
        </td></tr>
                <tr id="comment-header-13872655"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872655"><td bgcolor="#ffffff">
            <p>Commit 1558584 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558584" class="external-link" rel="nofollow">https://svn.apache.org/r1558584</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: maven config: fix map-reduce test compilation problem by adding dependency on morphline-core's test jar</p>
        </td></tr>
                <tr id="comment-header-13872662"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872662"><td bgcolor="#ffffff">
            <p>Commit 1558586 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558586" class="external-link" rel="nofollow">https://svn.apache.org/r1558586</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: make debugging these tests a whole lot easier by sending map reduce job logging to std out</p>
        </td></tr>
                <tr id="comment-header-13872665"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">15/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872665"><td bgcolor="#ffffff">
            <p>Commit 1558588 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558588" class="external-link" rel="nofollow">https://svn.apache.org/r1558588</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: IntelliJ config: morphlines-cell Solr contrib needs lucene-core test-scope dependency</p>
        </td></tr>
                <tr id="comment-header-13872916"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">16/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872916"><td bgcolor="#ffffff">
            <p>Commit 1558647 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1558647" class="external-link" rel="nofollow">https://svn.apache.org/r1558647</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Move CHANGES entry to 4.7</p>
        </td></tr>
                <tr id="comment-header-13872957"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">16/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872957"><td bgcolor="#ffffff">
            <p>Commit 1558670 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1558670" class="external-link" rel="nofollow">https://svn.apache.org/r1558670</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Throw an error if HdfsDirectoryFactory is not configured for now.</p>
        </td></tr>
                <tr id="comment-header-13872959"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">16/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13872959"><td bgcolor="#ffffff">
            <p>Commit 1558671 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1558671" class="external-link" rel="nofollow">https://svn.apache.org/r1558671</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Throw an error if HdfsDirectoryFactory is not configured for now.</p>
        </td></tr>
                <tr id="comment-header-13882522"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">27/Jan/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13882522"><td bgcolor="#ffffff">
            <p>Major performance issue that relates to this:</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-5667" title="Performance problem when not using hdfs block cache." class="issue-link" data-issue-key="SOLR-5667"><del>SOLR-5667</del></a> Performance problem when not using hdfs block cache.</p>
        </td></tr>
                <tr id="comment-header-13898232"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">11/Feb/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13898232"><td bgcolor="#ffffff">
            <p>Commit 1567337 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1567337" class="external-link" rel="nofollow">https://svn.apache.org/r1567337</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Implement the set-map-reduce-classpath.sh script.</p>
        </td></tr>
                <tr id="comment-header-13898238"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">11/Feb/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13898238"><td bgcolor="#ffffff">
            <p>Commit 1567340 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1567340" class="external-link" rel="nofollow">https://svn.apache.org/r1567340</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Implement the set-map-reduce-classpath.sh script.</p>
        </td></tr>
                <tr id="comment-header-13901180"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="cm" id="word_commented_cm" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cm">Christian Moen</a>
                                        <font size="-2">
            [
                <font color="#336699">14/Feb/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13901180"><td bgcolor="#ffffff">
            <p>I've been reading through (pretty much all) the comments on this JIRA and I'd like to thank you all for the great effort you have put into this.</p>
        </td></tr>
                <tr id="comment-header-13901471"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">14/Feb/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13901471"><td bgcolor="#ffffff">
            <p>Commit 1568317 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1568317" class="external-link" rel="nofollow">https://svn.apache.org/r1568317</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Add some readme files.</p>
        </td></tr>
                <tr id="comment-header-13901474"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">14/Feb/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13901474"><td bgcolor="#ffffff">
            <p>Commit 1568318 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1568318" class="external-link" rel="nofollow">https://svn.apache.org/r1568318</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Add some readme files.</p>
        </td></tr>
                <tr id="comment-header-13901475"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">14/Feb/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13901475"><td bgcolor="#ffffff">
            <p>Plenty of comments to go through <img class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/smile.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> Time to finally close this issue out. I'll file a new issue for some remaining work.</p>
        </td></tr>
                <tr id="comment-header-13901481"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="markrmiller@gmail.com" id="word_commented_markrmiller@gmail.com" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a>
                                        <font size="-2">
            [
                <font color="#336699">14/Feb/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13901481"><td bgcolor="#ffffff">
            <p>I filed <a href="https://issues.apache.org/jira/browse/SOLR-5729" title="Merge up Solr Morphlines contrib code to latest external changes." class="issue-link" data-issue-key="SOLR-5729"><del>SOLR-5729</del></a> for some additional work post 4.7.</p>
        </td></tr>
                <tr id="comment-header-13901516"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">14/Feb/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13901516"><td bgcolor="#ffffff">
            <p>Commit 1568328 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/trunk'<br/>
[ <a href="https://svn.apache.org/r1568328" class="external-link" rel="nofollow">https://svn.apache.org/r1568328</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Fix spelling.</p>
        </td></tr>
                <tr id="comment-header-13901517"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="jira-bot" id="word_commented_jira-bot" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jira-bot">ASF subversion and git services</a>
                                        <font size="-2">
            [
                <font color="#336699">14/Feb/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13901517"><td bgcolor="#ffffff">
            <p>Commit 1568329 from <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com" class="user-hover" rel="markrmiller@gmail.com">Mark Miller</a> in branch 'dev/branches/branch_4x'<br/>
[ <a href="https://svn.apache.org/r1568329" class="external-link" rel="nofollow">https://svn.apache.org/r1568329</a> ]</p>

<p><a href="https://issues.apache.org/jira/browse/SOLR-1301" title="Add a Solr contrib that allows for building Solr indexes via Hadoop&#39;s Map-Reduce." class="issue-link" data-issue-key="SOLR-1301"><del>SOLR-1301</del></a>: Fix spelling.</p>
        </td></tr>
                <tr id="comment-header-13942720"><td bgcolor="#f0f0f0">
            Comment by  
                                                        <a class="user-hover" rel="rulinma" id="word_commented_rulinma" href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rulinma">rulinma</a>
                                        <font size="-2">
            [
                <font color="#336699">21/Mar/14</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-13942720"><td bgcolor="#ffffff">
            <p>mark.</p>
        </td></tr>
            </table>
Generated at Sat Mar 22 13:35:11 UTC 2014 using JIRA 6.2#6252-sha1:aa343257d4ce030d9cb8c531be520be9fac1c996.

</body>
</html>